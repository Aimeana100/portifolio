/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t=function(e){const t=[];let n=0;for(let s=0;s<e.length;s++){let i=e.charCodeAt(s);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&s+1<e.length&&56320==(64512&e.charCodeAt(s+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++s)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let t=0;t<e.length;t+=3){const i=e[t],r=t+1<e.length,o=r?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(h=64)),s.push(n[u],n[l],n[h],n[d])}return s.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,s=0;for(;n<e.length;){const i=e[n++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=e[n++];t[s++]=String.fromCharCode((31&i)<<6|63&r)}else if(i>239&&i<365){const r=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[s++]=String.fromCharCode(55296+(r>>10)),t[s++]=String.fromCharCode(56320+(1023&r))}else{const r=e[n++],o=e[n++];t[s++]=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],r=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==r||null==o||null==a)throw Error();const c=i<<2|r>>4;if(s.push(c),64!==o){const e=r<<4&240|o>>2;if(s.push(e),64!==a){const e=o<<6&192|a;s.push(e)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},s=function(e){return function(e){const s=t(e);return n.encodeByteArray(s,!0)}(e).replace(/\./g,"")},i=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function r(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function a(){try{return"object"==typeof indexedDB}catch(e){return!1}}function c(){return new Promise(((e,t)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}const u=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&i(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},l=e=>{var t,n;return null===(n=null===(t=u())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},h=e=>{const t=l(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),s]:[t.substring(0,n),s]},d=e=>{var t;return null===(t=u())||void 0===t?void 0:t[`_${e}`]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function p(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],r=i?function(e,t){return e.replace(y,((e,n)=>{const s=t[n];return null!=s?String(s):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${r} (${s}).`;return new g(s,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),s=Object.keys(t);for(const i of n){if(!s.includes(i))return!1;const n=e[i],r=t[i];if(w(n)&&w(r)){if(!v(n,r))return!1}else if(n!==r)return!1}for(const e of s)if(!n.includes(e))return!1;return!0}function w(e){return null!==e&&"object"==typeof e}function _(e){const t=[];for(const[n,s]of Object.entries(e))Array.isArray(s)?s.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}function b(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,s]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(s)}})),t}function T(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class I{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let s;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");s=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===s.next&&(s.next=E),void 0===s.error&&(s.error=E),void 0===s.complete&&(s.complete=E);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch(e){}})),this.observers.push(s),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function E(){}function k(e,t=1e3,n=2){const s=t*Math.pow(n,e),i=Math.round(.5*s*(Math.random()-.5)*2);return Math.min(144e5,s+i)}function S(e){return e&&e._delegate?e._delegate:e}class C{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const A="[DEFAULT]";class R{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new f;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),s=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(s)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:A})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=A){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=A){return this.instances.has(e)}getOptions(e=A){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(s);return s}onInit(e,t){var n;const s=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&e(r,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(s=e,s===A?void 0:s),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var s;return n||null}normalizeInstanceIdentifier(e=A){return this.component?this.component.multipleInstances?e:A:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class D{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new R(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const N=[];var O,L;(L=O||(O={}))[L.DEBUG=0]="DEBUG",L[L.VERBOSE=1]="VERBOSE",L[L.INFO=2]="INFO",L[L.WARN=3]="WARN",L[L.ERROR=4]="ERROR",L[L.SILENT=5]="SILENT";const x={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},P=O.INFO,M={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},U=(e,t,...n)=>{if(t<e.logLevel)return;const s=(new Date).toISOString(),i=M[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${s}]  ${e.name}:`,...n)};class F{constructor(e){this.name=e,this._logLevel=P,this._logHandler=U,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in O))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?x[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...e),this._logHandler(this,O.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...e),this._logHandler(this,O.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,O.INFO,...e),this._logHandler(this,O.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,O.WARN,...e),this._logHandler(this,O.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...e),this._logHandler(this,O.ERROR,...e)}}let V,q;const B=new WeakMap,j=new WeakMap,$=new WeakMap,H=new WeakMap,z=new WeakMap;let K={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return j.get(e);if("objectStoreNames"===t)return e.objectStoreNames||$.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return W(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function G(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(q||(q=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Q(this),e),W(B.get(this))}:function(...e){return W(t.apply(Q(this),e))}:function(e,...n){const s=t.call(Q(this),e,...n);return $.set(s,e.sort?e.sort():[e]),W(s)}:(e instanceof IDBTransaction&&function(e){if(j.has(e))return;const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",r),e.removeEventListener("abort",r)},i=()=>{t(),s()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",r),e.addEventListener("abort",r)}));j.set(e,t)}(e),n=e,(V||(V=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,K):e);var t,n}function W(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",r)},i=()=>{t(W(e.result)),s()},r=()=>{n(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&B.set(t,e)})).catch((()=>{})),z.set(t,e),t}(e);if(H.has(e))return H.get(e);const t=G(e);return t!==e&&(H.set(e,t),z.set(t,e)),t}const Q=e=>z.get(e);function X(e,t,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(e,t),a=W(o);return s&&o.addEventListener("upgradeneeded",(e=>{s(W(o.result),e.oldVersion,e.newVersion,W(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}const J=["get","getKey","getAll","getAllKeys","count"],Y=["put","add","delete","clear"],Z=new Map;function ee(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Z.get(t))return Z.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,i=Y.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!i&&!J.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,i?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&r.done]))[0]};return Z.set(t,r),r}var te;te=K,K={...te,get:(e,t,n)=>ee(e,t)||te.get(e,t,n),has:(e,t)=>!!ee(e,t)||te.has(e,t)};class ne{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const se="@firebase/app",ie="0.9.0",re=new F("@firebase/app"),oe="[DEFAULT]",ae={[se]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ce=new Map,ue=new Map;function le(e,t){try{e.container.addComponent(t)}catch(n){re.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function he(e){const t=e.name;if(ue.has(t))return re.debug(`There were multiple attempts to register component ${t}.`),!1;ue.set(t,e);for(const t of ce.values())le(t,e);return!0}function de(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const fe=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class pe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new C("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fe.create("app-deleted",{appName:this._name})}}const ge="9.15.0";function me(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const s=Object.assign({name:oe,automaticDataCollectionEnabled:!1},t),i=s.name;if("string"!=typeof i||!i)throw fe.create("bad-app-name",{appName:String(i)});if(n||(n=(()=>{var e;return null===(e=u())||void 0===e?void 0:e.config})()),!n)throw fe.create("no-options");const r=ce.get(i);if(r){if(v(n,r.options)&&v(s,r.config))return r;throw fe.create("duplicate-app",{appName:i})}const o=new D(i);for(const e of ue.values())o.addComponent(e);const a=new pe(n,s,o);return ce.set(i,a),a}function ye(e=oe){const t=ce.get(e);if(!t&&e===oe)return me();if(!t)throw fe.create("no-app",{appName:e});return t}function ve(e,t,n){var s;let i=null!==(s=ae[e])&&void 0!==s?s:e;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const e=[`Unable to register library "${i}" with version "${t}":`];return r&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void re.warn(e.join(" "))}he(new C(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const we="firebase-heartbeat-store";let _e=null;function be(){return _e||(_e=X("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(we)}}).catch((e=>{throw fe.create("idb-open",{originalErrorMessage:e.message})}))),_e}async function Te(e,t){try{const n=(await be()).transaction(we,"readwrite"),s=n.objectStore(we);return await s.put(t,Ie(e)),n.done}catch(e){if(e instanceof g)re.warn(e.message);else{const t=fe.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});re.warn(t.message)}}}function Ie(e){return`${e.name}!${e.options.appId}`}class Ee{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Se(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=ke();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=ke(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let s=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Ce(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ce(n)>t){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),i=s(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function ke(){return(new Date).toISOString().substring(0,10)}class Se{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!a()&&c().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{return(await be()).transaction(we).objectStore(we).get(Ie(e))}catch(e){if(e instanceof g)re.warn(e.message);else{const t=fe.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});re.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Te(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Te(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ce(e){return s(JSON.stringify({version:2,heartbeats:e})).length}he(new C("platform-logger",(e=>new ne(e)),"PRIVATE")),he(new C("heartbeat",(e=>new Ee(e)),"PRIVATE")),ve(se,ie,""),ve(se,ie,"esm2017"),ve("fire-js",""),ve("firebase","9.15.0","app");const Ae="@firebase/installations",Re="0.6.0",De=`w:${Re}`,Ne="FIS_v2",Oe=new m("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Le(e){return e instanceof g&&e.code.includes("request-failed")}function xe({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Pe(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Me(e,t){const n=(await t.json()).error;return Oe.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Ue({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Fe(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Ve(e){return new Promise((t=>{setTimeout(t,e)}))}const qe=/^[cdef][\w-]{21}$/;function Be(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return qe.test(t)?t:""}catch(e){return""}}function je(e){return`${e.appName}!${e.appId}`}const $e=new Map;function He(e,t){const n=je(e);ze(n,t),function(e,t){const n=(!Ke&&"BroadcastChannel"in self&&(Ke=new BroadcastChannel("[Firebase] FID Change"),Ke.onmessage=e=>{ze(e.data.key,e.data.fid)}),Ke);n&&n.postMessage({key:e,fid:t}),0===$e.size&&Ke&&(Ke.close(),Ke=null)}(n,t)}function ze(e,t){const n=$e.get(e);if(n)for(const e of n)e(t)}let Ke=null;const Ge="firebase-installations-store";let We=null;function Qe(){return We||(We=X("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Ge)}})),We}async function Xe(e,t){const n=je(e),s=(await Qe()).transaction(Ge,"readwrite"),i=s.objectStore(Ge),r=await i.get(n);return await i.put(t,n),await s.done,r&&r.fid===t.fid||He(e,t.fid),t}async function Je(e){const t=je(e),n=(await Qe()).transaction(Ge,"readwrite");await n.objectStore(Ge).delete(t),await n.done}async function Ye(e,t){const n=je(e),s=(await Qe()).transaction(Ge,"readwrite"),i=s.objectStore(Ge),r=await i.get(n),o=t(r);return void 0===o?await i.delete(n):await i.put(o,n),await s.done,!o||r&&r.fid===o.fid||He(e,o.fid),o}async function Ze(e){let t;const n=await Ye(e.appConfig,(n=>{const s=function(e){return nt(e||{fid:Be(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Oe.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},s=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const s=xe(e),i=Ue(e),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={fid:n,authVersion:Ne,appId:e.appId,sdkVersion:De},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Fe((()=>fetch(s,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Pe(e.authToken)}}throw await Me("Create Installation",c)}(e,t);return Xe(e.appConfig,n)}catch(n){throw Le(n)&&409===n.customData.serverCode?await Je(e.appConfig):await Xe(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:s}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:et(e)}:{installationEntry:t}}(e,s);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function et(e){let t=await tt(e.appConfig);for(;1===t.registrationStatus;)await Ve(100),t=await tt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Ze(e);return n||t}return t}function tt(e){return Ye(e,(e=>{if(!e)throw Oe.create("installation-not-found");return nt(e)}))}function nt(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function st({appConfig:e,heartbeatServiceProvider:t},n){const s=function(e,{fid:t}){return`${xe(e)}/${t}/authTokens:generate`}(e,n),i=function(e,{refreshToken:t}){const n=Ue(e);return n.append("Authorization",function(e){return`${Ne} ${e}`}(t)),n}(e,n),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:De,appId:e.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Fe((()=>fetch(s,a)));if(c.ok)return Pe(await c.json());throw await Me("Generate Auth Token",c)}async function it(e,t=!1){let n;const s=await Ye(e.appConfig,(s=>{if(!ot(s))throw Oe.create("not-registered");const i=s.authToken;if(!t&&(2===(r=i).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(r)))return s;var r;if(1===i.requestStatus)return n=async function(e,t){let n=await rt(e.appConfig);for(;1===n.authToken.requestStatus;)await Ve(100),n=await rt(e.appConfig);const s=n.authToken;return 0===s.requestStatus?it(e,t):s}(e,t),s;{if(!navigator.onLine)throw Oe.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(s);return n=async function(e,t){try{const n=await st(e,t),s=Object.assign(Object.assign({},t),{authToken:n});return await Xe(e.appConfig,s),n}catch(n){if(!Le(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Xe(e.appConfig,n)}else await Je(e.appConfig);throw n}}(e,t),t}}));return n?await n:s.authToken}function rt(e){return Ye(e,(e=>{if(!ot(e))throw Oe.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function ot(e){return void 0!==e&&2===e.registrationStatus}function at(e){return Oe.create("missing-app-config-values",{valueName:e})}const ct="installations";he(new C(ct,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw at("App Configuration");if(!e.name)throw at("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw at(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:de(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),he(new C("installations-internal",(e=>{const t=de(e.getProvider("app").getImmediate(),ct).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:s}=await Ze(t);return s?s.catch(console.error):it(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await Ze(e);t&&await t}(n),(await it(n,t)).token}(t,e)}}),"PRIVATE")),ve(Ae,Re),ve(Ae,Re,"esm2017");const ut="analytics",lt="https://www.googletagmanager.com/gtag/js",ht=new F("@firebase/analytics");function dt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const ft=new m("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),pt=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function gt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function mt(e,t=pt,n){const{appId:s,apiKey:i,measurementId:r}=e.options;if(!s)throw ft.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:s};throw ft.create("no-api-key")}const o=t.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new vt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),yt({appId:s,apiKey:i,measurementId:r},o,a,t)}async function yt(e,{throttleEndTimeMillis:t,backoffCount:n},s,i=pt){var r;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,s)=>{const i=Math.max(t-Date.now(),0),r=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(r),s(ft.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(s,t)}catch(e){if(a)return ht.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:s}=e,i={method:"GET",headers:gt(s)},r="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(r,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw ft.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof g&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(i.deleteThrottleMetadata(o),a)return ht.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const u=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?k(n,i.intervalMillis,30):k(n,i.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(o,l),ht.debug(`Calling attemptFetch again in ${u} millis`),yt(e,l,s,i)}}class vt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let wt,_t;async function bt(e,t,n,s,i,r,o){var u;const l=mt(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ht.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>ht.error(e))),t.push(l);const h=async function(){if(!a())return ht.warn(ft.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await c()}catch(e){return ht.warn(ft.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?s.getId():void 0)),[d,f]=await Promise.all([l,h]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(lt)&&n.src.includes(e))return n;return null})(r)||function(e,t){const n=document.createElement("script");n.src=`${lt}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(r,d.measurementId),_t&&(i("consent","default",_t),_t=void 0),i("js",new Date);const p=null!==(u=null==o?void 0:o.config)&&void 0!==u?u:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),i("config",d.measurementId,p),wt&&(i("set",wt),wt=void 0),d.measurementId}class Tt{constructor(e){this.app=e}_delete(){return delete It[this.app.options.appId],Promise.resolve()}}let It={},Et=[];const kt={};let St,Ct,At="dataLayer",Rt=!1;function Dt(e,t,n){!function(){const e=[];if(o()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=ft.create("invalid-analytics-context",{errorInfo:t});ht.warn(n.message)}}();const s=e.options.appId;if(!s)throw ft.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ft.create("no-api-key");ht.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=It[s])throw ft.create("already-exists",{id:s});if(!Rt){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(At);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,s,i){let r=function(...e){window[s].push(arguments)};return window[i]&&"function"==typeof window[i]&&(r=window[i]),window[i]=function(e,t,n,s){return async function(i,r,o){try{"event"===i?await async function(e,t,n,s,i){try{let r=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const s=await dt(n);for(const n of e){const e=s.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){r=[];break}r.push(i)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",s,i||{})}catch(e){ht.error(e)}}(e,t,n,r,o):"config"===i?await async function(e,t,n,s,i,r){const o=s[i];try{if(o)await t[o];else{const e=(await dt(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){ht.error(e)}e("config",i,r)}(e,t,n,s,r,o):"consent"===i?e("consent","update",o):e("set",r)}catch(e){ht.error(e)}}}(r,e,t,n),{gtagCore:r,wrappedGtag:window[i]}}(It,Et,kt,At,"gtag");Ct=e,St=t,Rt=!0}return It[s]=bt(e,Et,kt,t,St,At,n),new Tt(e)}const Nt="@firebase/analytics",Ot="0.9.0";function Lt(e,t){var n='<option value="" > --- select --- </option>';return e.forEach(((e,s)=>{n+="<option "+(e.id==t?" selected ":"")+' value="'+e.id+'">'+e.title+" </option>"})),n}function xt(e,t){var n="";return e.forEach(((e,t)=>{console.log(e.comments),n+=`<div class="item">\n    <div class="img">\n      <img style='min-height: 140px' src="${e.image}" alt="" />\n    </div>\n    <div class="description">\n      <p class="date__desktop">\n        <img src="assets/images/Alarm.svg" alt="" />  ${Pt(e.created_at)} \n      </p>\n      <h3 class="title">\n        ${e.title}\n      </h3>\n\n      <div class="description__text">\n        ${e.description}\n      </div>\n\n      <div class="comment_views">\n        <p class="comments">\n          <img src="assets/images/inser_ comment.svg" alt="" />\n          <span>${e.comments.length}</span>\n        </p>\n\n        <p class="views">\n          <img src="assets/images/views.svg" alt="" />\n          <span>${e.views}</span>\n        </p>\n      </div>\n\n      <a views=${e.views} blog_id="${e.id}" href="blog-single.html?blog=${e.id}" class="read__more"\n        >Read more\n        <img src="assets/images/arrow_right_alt.svg" alt="" />\n      </a>\n    </div>\n  </div>`})),n}function Pt(e){let t=e.toDate();t.getMonth(),t.getDate(),t.getFullYear();const n=t;return n.getDate()+", "+["January","February","March","April","May","June","July","August","September","October","November","December"][Number(n.getMonth())]+" "+n.getFullYear()}he(new C(ut,((e,{options:t})=>Dt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),he(new C("analytics-internal",(function(e){try{const t=e.getProvider(ut).getImmediate();return{logEvent:(e,n,s)=>function(e,t,n,s){e=S(e),async function(e,t,n,s,i){if(i&&i.global)e("event",n,s);else{const i=await t;e("event",n,Object.assign(Object.assign({},s),{send_to:i}))}}(Ct,It[e.app.options.appId],t,n,s).catch((e=>ht.error(e)))}(t,e,n,s)}}catch(e){throw ft.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),ve(Nt,Ot),ve(Nt,Ot,"esm2017");var Mt,Ut="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e.g?e.g:"undefined"!=typeof self?self:{},Ft={},Vt=Vt||{},qt=Ut||self;function Bt(){}function jt(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function $t(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Ht="closure_uid_"+(1e9*Math.random()>>>0),zt=0;function Kt(e,t,n){return e.call.apply(e.bind,arguments)}function Gt(e,t,n){if(!e)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Wt(e,t,n){return(Wt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Kt:Gt).apply(null,arguments)}function Qt(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Xt(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,s){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return t.prototype[n].apply(e,i)}}function Jt(){this.s=this.s,this.o=this.o}Jt.prototype.s=!1,Jt.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Ht)&&e[Ht]||(e[Ht]=++zt))},Jt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Yt=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Zt(e){const t=e.length;if(0<t){const n=Array(t);for(let s=0;s<t;s++)n[s]=e[s];return n}return[]}function en(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(jt(n)){const t=e.length||0,s=n.length||0;e.length=t+s;for(let i=0;i<s;i++)e[t+i]=n[i]}else e.push(n)}}function tn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}tn.prototype.h=function(){this.defaultPrevented=!0};var nn=function(){if(!qt.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{qt.addEventListener("test",Bt,t),qt.removeEventListener("test",Bt,t)}catch(e){}return e}();function sn(e){return/^[\s\xa0]*$/.test(e)}var rn=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function on(e,t){return e<t?-1:e>t?1:0}function an(){var e=qt.navigator;return e&&(e=e.userAgent)?e:""}function cn(e){return-1!=an().indexOf(e)}function un(e){return un[" "](e),e}un[" "]=Bt;var ln,hn,dn=cn("Opera"),fn=cn("Trident")||cn("MSIE"),pn=cn("Edge"),gn=pn||fn,mn=cn("Gecko")&&!(-1!=an().toLowerCase().indexOf("webkit")&&!cn("Edge"))&&!(cn("Trident")||cn("MSIE"))&&!cn("Edge"),yn=-1!=an().toLowerCase().indexOf("webkit")&&!cn("Edge");function vn(){var e=qt.document;return e?e.documentMode:void 0}e:{var wn="",_n=(hn=an(),mn?/rv:([^\);]+)(\)|;)/.exec(hn):pn?/Edge\/([\d\.]+)/.exec(hn):fn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(hn):yn?/WebKit\/(\S+)/.exec(hn):dn?/(?:Version)[ \/]?(\S+)/.exec(hn):void 0);if(_n&&(wn=_n?_n[1]:""),fn){var bn=vn();if(null!=bn&&bn>parseFloat(wn)){ln=String(bn);break e}}ln=wn}var Tn,In={};function En(){return function(e){var t=In;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let e=0;const t=rn(String(ln)).split("."),n=rn("9").split("."),s=Math.max(t.length,n.length);for(let o=0;0==e&&o<s;o++){var i=t[o]||"",r=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==i[0].length&&0==r[0].length)break;e=on(0==i[1].length?0:parseInt(i[1],10),0==r[1].length?0:parseInt(r[1],10))||on(0==i[2].length,0==r[2].length)||on(i[2],r[2]),i=i[3],r=r[3]}while(0==e)}return 0<=e}()}()}qt.document&&fn?Tn=vn()||parseInt(ln,10)||void 0:Tn=void 0;var kn=Tn;function Sn(e,t){if(tn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,s=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(mn){e:{try{un(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Cn[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Sn.X.h.call(this)}}Xt(Sn,tn);var Cn={2:"touch",3:"pen",4:"mouse"};Sn.prototype.h=function(){Sn.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var An="closure_listenable_"+(1e6*Math.random()|0),Rn=0;function Dn(e,t,n,s,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!s,this.ha=i,this.key=++Rn,this.ba=this.ea=!1}function Nn(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function On(e,t,n){for(const s in e)t.call(n,e[s],s,e)}function Ln(e){const t={};for(const n in e)t[n]=e[n];return t}const xn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pn(e,t){let n,s;for(let t=1;t<arguments.length;t++){for(n in s=arguments[t],s)e[n]=s[n];for(let t=0;t<xn.length;t++)n=xn[t],Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}}function Mn(e){this.src=e,this.g={},this.h=0}function Un(e,t){var n=t.type;if(n in e.g){var s,i=e.g[n],r=Yt(i,t);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(Nn(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Fn(e,t,n,s){for(var i=0;i<e.length;++i){var r=e[i];if(!r.ba&&r.listener==t&&r.capture==!!n&&r.ha==s)return i}return-1}Mn.prototype.add=function(e,t,n,s,i){var r=e.toString();(e=this.g[r])||(e=this.g[r]=[],this.h++);var o=Fn(e,t,s,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new Dn(t,this.src,r,!!s,i)).ea=n,e.push(t)),t};var Vn="closure_lm_"+(1e6*Math.random()|0),qn={};function Bn(e,t,n,s,i){if(s&&s.once)return $n(e,t,n,s,i);if(Array.isArray(t)){for(var r=0;r<t.length;r++)Bn(e,t[r],n,s,i);return null}return n=Xn(n),e&&e[An]?e.N(t,n,$t(s)?!!s.capture:!!s,i):jn(e,t,n,!1,s,i)}function jn(e,t,n,s,i,r){if(!t)throw Error("Invalid event type");var o=$t(i)?!!i.capture:!!i,a=Wn(e);if(a||(e[Vn]=a=new Mn(e)),(n=a.add(t,n,s,o,r)).proxy)return n;if(s=function(){const e=Gn;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=s,s.src=e,s.listener=n,e.addEventListener)nn||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),s,i);else if(e.attachEvent)e.attachEvent(Kn(t.toString()),s);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(s)}return n}function $n(e,t,n,s,i){if(Array.isArray(t)){for(var r=0;r<t.length;r++)$n(e,t[r],n,s,i);return null}return n=Xn(n),e&&e[An]?e.O(t,n,$t(s)?!!s.capture:!!s,i):jn(e,t,n,!0,s,i)}function Hn(e,t,n,s,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)Hn(e,t[r],n,s,i);else s=$t(s)?!!s.capture:!!s,n=Xn(n),e&&e[An]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Fn(r=e.g[t],n,s,i))&&(Nn(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete e.g[t],e.h--))):e&&(e=Wn(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Fn(t,n,s,i)),(n=-1<e?t[e]:null)&&zn(n))}function zn(e){if("number"!=typeof e&&e&&!e.ba){var t=e.src;if(t&&t[An])Un(t.i,e);else{var n=e.type,s=e.proxy;t.removeEventListener?t.removeEventListener(n,s,e.capture):t.detachEvent?t.detachEvent(Kn(n),s):t.addListener&&t.removeListener&&t.removeListener(s),(n=Wn(t))?(Un(n,e),0==n.h&&(n.src=null,t[Vn]=null)):Nn(e)}}}function Kn(e){return e in qn?qn[e]:qn[e]="on"+e}function Gn(e,t){if(e.ba)e=!0;else{t=new Sn(t,this);var n=e.listener,s=e.ha||e.src;e.ea&&zn(e),e=n.call(s,t)}return e}function Wn(e){return(e=e[Vn])instanceof Mn?e:null}var Qn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xn(e){return"function"==typeof e?e:(e[Qn]||(e[Qn]=function(t){return e.handleEvent(t)}),e[Qn])}function Jn(){Jt.call(this),this.i=new Mn(this),this.P=this,this.I=null}function Yn(e,t){var n,s=e.I;if(s)for(n=[];s;s=s.I)n.push(s);if(e=e.P,s=t.type||t,"string"==typeof t)t=new tn(t,e);else if(t instanceof tn)t.target=t.target||e;else{var i=t;Pn(t=new tn(s,e),i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var o=t.g=n[r];i=Zn(o,s,!0,t)&&i}if(i=Zn(o=t.g=e,s,!0,t)&&i,i=Zn(o,s,!1,t)&&i,n)for(r=0;r<n.length;r++)i=Zn(o=t.g=n[r],s,!1,t)&&i}function Zn(e,t,n,s){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,r=0;r<t.length;++r){var o=t[r];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&Un(e.i,o),i=!1!==a.call(c,s)&&i}}return i&&!s.defaultPrevented}Xt(Jn,Jt),Jn.prototype[An]=!0,Jn.prototype.removeEventListener=function(e,t,n,s){Hn(this,e,t,n,s)},Jn.prototype.M=function(){if(Jn.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Nn(n[s]);delete t.g[e],t.h--}}this.I=null},Jn.prototype.N=function(e,t,n,s){return this.i.add(String(e),t,!1,n,s)},Jn.prototype.O=function(e,t,n,s){return this.i.add(String(e),t,!0,n,s)};var es=qt.JSON.stringify;function ts(){var e=cs;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ns,ss=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new is),(e=>e.reset()));class is{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function rs(e){qt.setTimeout((()=>{throw e}),0)}function os(e,t){ns||function(){var e=qt.Promise.resolve(void 0);ns=function(){e.then(us)}}(),as||(ns(),as=!0),cs.add(e,t)}var as=!1,cs=new class{constructor(){this.h=this.g=null}add(e,t){const n=ss.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function us(){for(var e;e=ts();){try{e.h.call(e.g)}catch(e){rs(e)}var t=ss;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}as=!1}function ls(e,t){Jn.call(this),this.h=e||1,this.g=t||qt,this.j=Wt(this.lb,this),this.l=Date.now()}function hs(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function ds(e,t,n){if("function"==typeof e)n&&(e=Wt(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Wt(e.handleEvent,e)}return 2147483647<Number(t)?-1:qt.setTimeout(e,t||0)}function fs(e){e.g=ds((()=>{e.g=null,e.i&&(e.i=!1,fs(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Xt(ls,Jn),(Mt=ls.prototype).ca=!1,Mt.R=null,Mt.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Yn(this,"tick"),this.ca&&(hs(this),this.start()))}},Mt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Mt.M=function(){ls.X.M.call(this),hs(this),delete this.g};class ps extends Jt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:fs(this)}M(){super.M(),this.g&&(qt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gs(e){Jt.call(this),this.h=e,this.g={}}Xt(gs,Jt);var ms=[];function ys(e,t,n,s){Array.isArray(n)||(n&&(ms[0]=n.toString()),n=ms);for(var i=0;i<n.length;i++){var r=Bn(t,n[i],s||e.handleEvent,!1,e.h||e);if(!r)break;e.g[r.key]=r}}function vs(e){On(e.g,(function(e,t){this.g.hasOwnProperty(t)&&zn(e)}),e),e.g={}}function ws(){this.g=!0}function _s(e,t,n,s){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var s=n[e];if(!(2>s.length)){var i=s[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return es(n)}catch(e){return t}}(e,n)+(s?" "+s:"")}))}gs.prototype.M=function(){gs.X.M.call(this),vs(this)},gs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ws.prototype.Aa=function(){this.g=!1},ws.prototype.info=function(){};var bs={},Ts=null;function Is(){return Ts=Ts||new Jn}function Es(e){tn.call(this,bs.Pa,e)}function ks(e){const t=Is();Yn(t,new Es(t))}function Ss(e,t){tn.call(this,bs.STAT_EVENT,e),this.stat=t}function Cs(e){const t=Is();Yn(t,new Ss(t,e))}function As(e,t){tn.call(this,bs.Qa,e),this.size=t}function Rs(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return qt.setTimeout((function(){e()}),t)}bs.Pa="serverreachability",Xt(Es,tn),bs.STAT_EVENT="statevent",Xt(Ss,tn),bs.Qa="timingevent",Xt(As,tn);var Ds={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Ns={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Os(){}function Ls(e){return e.h||(e.h=e.i())}function xs(){}Os.prototype.h=null;var Ps,Ms={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Us(){tn.call(this,"d")}function Fs(){tn.call(this,"c")}function Vs(){}function qs(e,t,n,s){this.l=e,this.j=t,this.m=n,this.U=s||1,this.S=new gs(this),this.O=js,e=gn?125:void 0,this.T=new ls(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Bs}function Bs(){this.i=null,this.g="",this.h=!1}Xt(Us,tn),Xt(Fs,tn),Xt(Vs,Os),Vs.prototype.g=function(){return new XMLHttpRequest},Vs.prototype.i=function(){return{}},Ps=new Vs;var js=45e3,$s={},Hs={};function zs(e,t,n){e.K=1,e.v=li(ri(t)),e.s=n,e.P=!0,Ks(e,null)}function Ks(e,t){e.F=Date.now(),Xs(e),e.A=ri(e.v);var n=e.A,s=e.U;Array.isArray(s)||(s=[String(s)]),Ii(n.i,"t",s),e.C=0,n=e.l.H,e.h=new Bs,e.g=Tr(e.l,n?t:null,!e.s),0<e.N&&(e.L=new ps(Wt(e.La,e,e.g),e.N)),ys(e.S,e.g,"readystatechange",e.ib),t=e.H?Ln(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),ks(),function(e,t,n,s,i,r){e.info((function(){if(e.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+s+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Gs(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Da}function Ws(e,t,n){let s,i=!0;for(;!e.I&&e.C<n.length;){if(s=Qs(e,n),s==Hs){4==t&&(e.o=4,Cs(14),i=!1),_s(e.j,e.m,null,"[Incomplete Response]");break}if(s==$s){e.o=4,Cs(15),_s(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}_s(e.j,e.m,s,null),ti(e,s)}Gs(e)&&s!=Hs&&s!=$s&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Cs(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),pr(t),t.K=!0,Cs(11))):(_s(e.j,e.m,n,"[Invalid Chunked Response]"),ei(e),Zs(e))}function Qs(e,t){var n=e.C,s=t.indexOf("\n",n);return-1==s?Hs:(n=Number(t.substring(n,s)),isNaN(n)?$s:(s+=1)+n>t.length?Hs:(t=t.substr(s,n),e.C=s+n,t))}function Xs(e){e.V=Date.now()+e.O,Js(e,e.O)}function Js(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Rs(Wt(e.gb,e),t)}function Ys(e){e.B&&(qt.clearTimeout(e.B),e.B=null)}function Zs(e){0==e.l.G||e.I||yr(e.l,e)}function ei(e){Ys(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,hs(e.T),vs(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function ti(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Ri(n.h,e)))if(!e.J&&Ri(n.h,e)&&3==n.G){try{var s=n.Fa.g.parse(t)}catch(e){s=null}if(Array.isArray(s)&&3==s.length){var i=s;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;mr(n),or(n)}fr(n),Cs(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=Rs(Wt(n.cb,n),6e3));if(1>=Ai(n.h)&&n.ja){try{n.ja()}catch(e){}n.ja=void 0}}else wr(n,11)}else if((e.J||n.g==e)&&mr(n),!sn(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const t=u[3];null!=t&&(n.ma=t,n.j.info("VER="+n.ma));const i=u[4];null!=i&&(n.Ca=i,n.j.info("SVER="+n.Ca));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(s=1.5*l,n.J=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var r=s.h;r.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(Di(r,r.h),r.h=null))}if(s.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(s.za=e,ui(s.F,s.D,e))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=e;if((s=n).sa=br(s,s.H?s.ka:null,s.V),o.J){Ni(s.h,o);var a=o,c=s.J;c&&a.setTimeout(c),a.B&&(Ys(a),Xs(a)),s.g=o}else dr(s);0<n.i.length&&cr(n)}else"stop"!=u[0]&&"close"!=u[0]||wr(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?wr(n,7):rr(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}ks()}catch(e){}}function ni(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(jt(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(jt(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const s in e)t[n++]=s;return t}}}(e),s=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(jt(e)){for(var t=[],n=e.length,s=0;s<n;s++)t.push(e[s]);return t}for(s in t=[],n=0,e)t[n++]=e[s];return t}(e),i=s.length,r=0;r<i;r++)t.call(void 0,s[r],n&&n[r],e)}(Mt=qs.prototype).setTimeout=function(e){this.O=e},Mt.ib=function(e){e=e.target;const t=this.L;t&&3==Zi(e)?t.l():this.La(e)},Mt.La=function(e){try{if(e==this.g)e:{const l=Zi(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>l)&&(3!=l||gn||this.g&&(this.h.h||this.g.fa()||er(this.g)))){this.I||4!=l||7==t||ks(),Ys(this);var n=this.g.aa();this.Y=n;t:if(Gs(this)){var s=er(this.g);e="";var i=s.length,r=4==Zi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ei(this),Zs(this);var o="";break t}this.h.i=new qt.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(s[t],{stream:r&&t==i-1});s.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(e,t,n,s,i,r,o){e.info((function(){return"XMLHTTP RESP ("+s+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.U,l,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sn(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Cs(12),ei(this),Zs(this);break e}_s(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ti(this,n)}this.P?(Ws(this,l,o),gn&&this.i&&3==l&&(ys(this.S,this.T,"tick",this.hb),this.T.start())):(_s(this.j,this.m,o,null),ti(this,o)),4==l&&ei(this),this.i&&!this.I&&(4==l?yr(this.l,this):(this.i=!1,Xs(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Cs(12)):(this.o=0,Cs(13)),ei(this),Zs(this)}}}catch(e){}},Mt.hb=function(){if(this.g){var e=Zi(this.g),t=this.g.fa();this.C<t.length&&(Ys(this),Ws(this,e,t),this.i&&4!=e&&Xs(this))}},Mt.cancel=function(){this.I=!0,ei(this)},Mt.gb=function(){this.B=null;const e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(ks(),Cs(17)),ei(this),this.o=2,Zs(this)):Js(this,this.V-e)};var si=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ii(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof ii){this.h=void 0!==t?t:e.h,oi(this,e.j),this.s=e.s,this.g=e.g,ai(this,e.m),this.l=e.l,t=e.i;var n=new wi;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ci(this,n),this.o=e.o}else e&&(n=String(e).match(si))?(this.h=!!t,oi(this,n[1]||"",!0),this.s=hi(n[2]||""),this.g=hi(n[3]||"",!0),ai(this,n[4]),this.l=hi(n[5]||"",!0),ci(this,n[6]||"",!0),this.o=hi(n[7]||"")):(this.h=!!t,this.i=new wi(null,this.h))}function ri(e){return new ii(e)}function oi(e,t,n){e.j=n?hi(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ai(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ci(e,t,n){t instanceof wi?(e.i=t,function(e,t){t&&!e.j&&(_i(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(bi(this,t),Ii(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=di(t,yi)),e.i=new wi(t,e.h))}function ui(e,t,n){e.i.set(t,n)}function li(e){return ui(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function hi(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function di(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,fi),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function fi(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ii.prototype.toString=function(){var e=[],t=this.j;t&&e.push(di(t,pi,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(di(t,pi,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(di(n,"/"==n.charAt(0)?mi:gi,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",di(n,vi)),e.join("")};var pi=/[#\/\?@]/g,gi=/[#\?:]/g,mi=/[#\?]/g,yi=/[#\?@]/g,vi=/#/g;function wi(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _i(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var s=e[n].indexOf("="),i=null;if(0<=s){var r=e[n].substring(0,s);i=e[n].substring(s+1)}else r=e[n];t(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function bi(e,t){_i(e),t=Ei(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ti(e,t){return _i(e),t=Ei(e,t),e.g.has(t)}function Ii(e,t,n){bi(e,t),0<n.length&&(e.i=null,e.g.set(Ei(e,t),Zt(n)),e.h+=n.length)}function Ei(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function ki(e){this.l=e||Si,e=qt.PerformanceNavigationTiming?0<(e=qt.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(qt.g&&qt.g.Ga&&qt.g.Ga()&&qt.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Mt=wi.prototype).add=function(e,t){_i(this),this.i=null,e=Ei(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Mt.forEach=function(e,t){_i(this),this.g.forEach((function(n,s){n.forEach((function(n){e.call(t,n,s,this)}),this)}),this)},Mt.oa=function(){_i(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let s=0;s<t.length;s++){const i=e[s];for(let e=0;e<i.length;e++)n.push(t[s])}return n},Mt.W=function(e){_i(this);let t=[];if("string"==typeof e)Ti(this,e)&&(t=t.concat(this.g.get(Ei(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Mt.set=function(e,t){return _i(this),this.i=null,Ti(this,e=Ei(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Mt.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},Mt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var s=t[n];const r=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var i=r;""!==o[s]&&(i+="="+encodeURIComponent(String(o[s]))),e.push(i)}}return this.i=e.join("&")};var Si=10;function Ci(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ai(e){return e.h?1:e.g?e.g.size:0}function Ri(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Di(e,t){e.g?e.g.add(t):e.h=t}function Ni(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Oi(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return Zt(e.i)}function Li(){}function xi(){this.g=new Li}function Pi(e,t,n){const s=n||"";try{ni(e,(function(e,n){let i=e;$t(e)&&(i=es(e)),t.push(s+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(s+"type="+encodeURIComponent("_badmap")),e}}function Mi(e,t,n,s,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(s)}catch(e){}}function Ui(e){this.l=e.ac||null,this.j=e.jb||!1}function Fi(e,t){Jn.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Vi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ki.prototype.cancel=function(){if(this.i=Oi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},Li.prototype.stringify=function(e){return qt.JSON.stringify(e,void 0)},Li.prototype.parse=function(e){return qt.JSON.parse(e,void 0)},Xt(Ui,Os),Ui.prototype.g=function(){return new Fi(this.l,this.j)},Ui.prototype.i=function(e){return function(){return e}}({}),Xt(Fi,Jn);var Vi=0;function qi(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function Bi(e){e.readyState=4,e.l=null,e.j=null,e.A=null,ji(e)}function ji(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Mt=Fi.prototype).open=function(e,t){if(this.readyState!=Vi)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,ji(this)},Mt.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||qt).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Mt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Bi(this)),this.readyState=Vi},Mt.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,ji(this)),this.g&&(this.readyState=3,ji(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==qt.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qi(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},Mt.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Bi(this):ji(this),3==this.readyState&&qi(this)}},Mt.Va=function(e){this.g&&(this.response=this.responseText=e,Bi(this))},Mt.Ua=function(e){this.g&&(this.response=e,Bi(this))},Mt.ga=function(){this.g&&Bi(this)},Mt.setRequestHeader=function(e,t){this.v.append(e,t)},Mt.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Mt.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Fi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var $i=qt.JSON.parse;function Hi(e){Jn.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zi,this.K=this.L=!1}Xt(Hi,Jn);var zi="",Ki=/^https?$/i,Gi=["POST","PUT"];function Wi(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Qi(e),Ji(e)}function Qi(e){e.D||(e.D=!0,Yn(e,"complete"),Yn(e,"error"))}function Xi(e){if(e.h&&void 0!==Vt&&(!e.C[1]||4!=Zi(e)||2!=e.aa()))if(e.v&&4==Zi(e))ds(e.Ha,0,e);else if(Yn(e,"readystatechange"),4==Zi(e)){e.h=!1;try{const a=e.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===a){var i=String(e.H).match(si)[1]||null;if(!i&&qt.self&&qt.self.location){var r=qt.self.location.protocol;i=r.substr(0,r.length-1)}s=!Ki.test(i?i.toLowerCase():"")}n=s}if(n)Yn(e,"complete"),Yn(e,"success");else{e.m=6;try{var o=2<Zi(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.aa()+"]",Qi(e)}}finally{Ji(e)}}}function Ji(e,t){if(e.g){Yi(e);const n=e.g,s=e.C[0]?Bt:null;e.g=null,e.C=null,t||Yn(e,"ready");try{n.onreadystatechange=s}catch(e){}}}function Yi(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(qt.clearTimeout(e.A),e.A=null)}function Zi(e){return e.g?e.g.readyState:0}function er(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case zi:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tr(e){let t="";return On(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function nr(e,t,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=tr(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ui(e,t,n))}function sr(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function ir(e){this.Ca=0,this.i=[],this.j=new ws,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=sr("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=sr("baseRetryDelayMs",5e3,e),this.bb=sr("retryDelaySeedMs",1e4,e),this.$a=sr("forwardChannelMaxRetries",2,e),this.ta=sr("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new ki(e&&e.concurrentRequestLimit),this.Fa=new xi,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function rr(e){if(ar(e),3==e.G){var t=e.U++,n=ri(e.F);ui(n,"SID",e.I),ui(n,"RID",t),ui(n,"TYPE","terminate"),lr(e,n),(t=new qs(e,e.j,t,void 0)).K=2,t.v=li(ri(n)),n=!1,qt.navigator&&qt.navigator.sendBeacon&&(n=qt.navigator.sendBeacon(t.v.toString(),"")),!n&&qt.Image&&((new Image).src=t.v,n=!0),n||(t.g=Tr(t.l,null),t.g.da(t.v)),t.F=Date.now(),Xs(t)}_r(e)}function or(e){e.g&&(pr(e),e.g.cancel(),e.g=null)}function ar(e){or(e),e.u&&(qt.clearTimeout(e.u),e.u=null),mr(e),e.h.cancel(),e.m&&("number"==typeof e.m&&qt.clearTimeout(e.m),e.m=null)}function cr(e){Ci(e.h)||e.m||(e.m=!0,os(e.Ja,e),e.C=0)}function ur(e,t){var n;n=t?t.m:e.U++;const s=ri(e.F);ui(s,"SID",e.I),ui(s,"RID",n),ui(s,"AID",e.T),lr(e,s),e.o&&e.s&&nr(s,e.o,e.s),n=new qs(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=hr(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),Di(e.h,n),zs(n,s,t)}function lr(e,t){e.ia&&On(e.ia,(function(e,n){ui(t,n,e)})),e.l&&ni({},(function(e,n){ui(t,n,e)}))}function hr(e,t,n){n=Math.min(e.i.length,n);var s=e.l?Wt(e.l.Ra,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let r=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),r=!1;else try{Pi(a,e,"req"+n+"_")}catch(e){s&&s(a)}}if(r){s=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,s}function dr(e){e.g||e.u||(e.Z=1,os(e.Ia,e),e.A=0)}function fr(e){return!(e.g||e.u||3<=e.A||(e.Z++,e.u=Rs(Wt(e.Ia,e),vr(e,e.A)),e.A++,0))}function pr(e){null!=e.B&&(qt.clearTimeout(e.B),e.B=null)}function gr(e){e.g=new qs(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=ri(e.sa);ui(t,"RID","rpc"),ui(t,"SID",e.I),ui(t,"CI",e.L?"0":"1"),ui(t,"AID",e.T),ui(t,"TYPE","xmlhttp"),lr(e,t),e.o&&e.s&&nr(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=li(ri(t)),n.s=null,n.P=!0,Ks(n,e)}function mr(e){null!=e.v&&(qt.clearTimeout(e.v),e.v=null)}function yr(e,t){var n=null;if(e.g==t){mr(e),pr(e),e.g=null;var s=2}else{if(!Ri(e.h,t))return;n=t.D,Ni(e.h,t),s=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==s){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Yn(s=Is(),new As(s,n)),cr(e)}else dr(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==s&&function(e,t){return!(Ai(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.C>=(e.Za?0:e.$a)||(e.m=Rs(Wt(e.Ja,e,t),vr(e,e.C)),e.C++,0)))}(e,t)||2==s&&fr(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:wr(e,5);break;case 4:wr(e,10);break;case 3:wr(e,6);break;default:wr(e,2)}}function vr(e,t){let n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function wr(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var s=Wt(e.kb,e);n||(n=new ii("//www.google.com/images/cleardot.gif"),qt.location&&"http"==qt.location.protocol||oi(n,"https"),li(n)),function(e,t){const n=new ws;if(qt.Image){const s=new Image;s.onload=Qt(Mi,n,s,"TestLoadImage: loaded",!0,t),s.onerror=Qt(Mi,n,s,"TestLoadImage: error",!1,t),s.onabort=Qt(Mi,n,s,"TestLoadImage: abort",!1,t),s.ontimeout=Qt(Mi,n,s,"TestLoadImage: timeout",!1,t),qt.setTimeout((function(){s.ontimeout&&s.ontimeout()}),1e4),s.src=e}else t(!1)}(n.toString(),s)}else Cs(2);e.G=0,e.l&&e.l.va(t),_r(e),ar(e)}function _r(e){if(e.G=0,e.la=[],e.l){const t=Oi(e.h);0==t.length&&0==e.i.length||(en(e.la,t),en(e.la,e.i),e.h.i.length=0,Zt(e.i),e.i.length=0),e.l.ua()}}function br(e,t,n){var s=n instanceof ii?ri(n):new ii(n,void 0);if(""!=s.g)t&&(s.g=t+"."+s.g),ai(s,s.m);else{var i=qt.location;s=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var r=new ii(null,void 0);s&&oi(r,s),t&&(r.g=t),i&&ai(r,i),n&&(r.l=n),s=r}return n=e.D,t=e.za,n&&t&&ui(s,n,t),ui(s,"VER",e.ma),lr(e,s),s}function Tr(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Hi(new Ui({jb:!0})):new Hi(e.ra)).Ka(e.H),t}function Ir(){}function Er(){if(fn&&!(10<=Number(kn)))throw Error("Environmental error: no available transport.")}function kr(e,t){Jn.call(this),this.g=new ir(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!sn(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!sn(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Ar(this)}function Sr(e){Us.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Cr(){Fs.call(this),this.status=1}function Ar(e){this.g=e}(Mt=Hi.prototype).Ka=function(e){this.L=e},Mt.da=function(e,t,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ps.g(),this.C=this.u?Ls(this.u):Ls(Ps),this.g.onreadystatechange=Wt(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void Wi(this,e)}if(e=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var i in s)n.set(i,s[i]);else{if("function"!=typeof s.keys||"function"!=typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const e of s.keys())n.set(e,s.get(e))}s=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=qt.FormData&&e instanceof qt.FormData,!(0<=Yt(Gi,t))||s||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yi(this),0<this.B&&((this.K=function(e){return fn&&En()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Wt(this.qa,this)):this.A=ds(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Wi(this,e)}},Mt.qa=function(){void 0!==Vt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yn(this,"timeout"),this.abort(8))},Mt.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Yn(this,"complete"),Yn(this,"abort"),Ji(this))},Mt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ji(this,!0)),Hi.X.M.call(this)},Mt.Ha=function(){this.s||(this.F||this.v||this.l?Xi(this):this.fb())},Mt.fb=function(){Xi(this)},Mt.aa=function(){try{return 2<Zi(this)?this.g.status:-1}catch(e){return-1}},Mt.fa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Mt.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),$i(t)}},Mt.Ea=function(){return this.m},Mt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Mt=ir.prototype).ma=8,Mt.G=1,Mt.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new qs(this,this.j,e,void 0);let r=this.s;if(this.S&&(r?(r=Ln(r),Pn(r,this.S)):r=this.S),null!==this.o||this.N||(i.H=r,r=null),this.O)e:{for(var t=0,n=0;n<this.i.length;n++){var s=this.i[n];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hr(this,i,t),ui(n=ri(this.F),"RID",e),ui(n,"CVER",22),this.D&&ui(n,"X-HTTP-Session-Id",this.D),lr(this,n),r&&(this.N?t="headers="+encodeURIComponent(String(tr(r)))+"&"+t:this.o&&nr(n,this.o,r)),Di(this.h,i),this.Ya&&ui(n,"TYPE","init"),this.O?(ui(n,"$req",t),ui(n,"SID","null"),i.Z=!0,zs(i,n,null)):zs(i,n,t),this.G=2}}else 3==this.G&&(e?ur(this,e):0==this.i.length||Ci(this.h)||ur(this))},Mt.Ia=function(){if(this.u=null,gr(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=Rs(Wt(this.eb,this),e)}},Mt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Cs(10),or(this),gr(this))},Mt.cb=function(){null!=this.v&&(this.v=null,or(this),fr(this),Cs(19))},Mt.kb=function(e){e?(this.j.info("Successfully pinged google.com"),Cs(2)):(this.j.info("Failed to ping google.com"),Cs(1))},(Mt=Ir.prototype).xa=function(){},Mt.wa=function(){},Mt.va=function(){},Mt.ua=function(){},Mt.Ra=function(){},Er.prototype.g=function(e,t){return new kr(e,t)},Xt(kr,Jn),kr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;Cs(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=br(e,null,e.V),cr(e)},kr.prototype.close=function(){rr(this.g)},kr.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=es(e),e=n);t.i.push(new class{constructor(e,t){this.h=e,this.g=t}}(t.ab++,e)),3==t.G&&cr(t)},kr.prototype.M=function(){this.g.l=null,delete this.j,rr(this.g),delete this.g,kr.X.M.call(this)},Xt(Sr,Us),Xt(Cr,Fs),Xt(Ar,Ir),Ar.prototype.xa=function(){Yn(this.g,"a")},Ar.prototype.wa=function(e){Yn(this.g,new Sr(e))},Ar.prototype.va=function(e){Yn(this.g,new Cr)},Ar.prototype.ua=function(){Yn(this.g,"b")},Er.prototype.createWebChannel=Er.prototype.g,kr.prototype.send=kr.prototype.u,kr.prototype.open=kr.prototype.m,kr.prototype.close=kr.prototype.close,Ds.NO_ERROR=0,Ds.TIMEOUT=8,Ds.HTTP_ERROR=6,Ns.COMPLETE="complete",xs.EventType=Ms,Ms.OPEN="a",Ms.CLOSE="b",Ms.ERROR="c",Ms.MESSAGE="d",Jn.prototype.listen=Jn.prototype.N,Hi.prototype.listenOnce=Hi.prototype.O,Hi.prototype.getLastError=Hi.prototype.Oa,Hi.prototype.getLastErrorCode=Hi.prototype.Ea,Hi.prototype.getStatus=Hi.prototype.aa,Hi.prototype.getResponseJson=Hi.prototype.Sa,Hi.prototype.getResponseText=Hi.prototype.fa,Hi.prototype.send=Hi.prototype.da,Hi.prototype.setWithCredentials=Hi.prototype.Ka;var Rr=Ft.createWebChannelTransport=function(){return new Er},Dr=Ft.getStatEventTarget=function(){return Is()},Nr=Ft.ErrorCode=Ds,Or=Ft.EventType=Ns,Lr=Ft.Event=bs,xr=Ft.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Pr=Ft.FetchXmlHttpFactory=Ui,Mr=Ft.WebChannel=xs,Ur=Ft.XhrIo=Hi;const Fr="@firebase/firestore";class Vr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vr.UNAUTHENTICATED=new Vr(null),Vr.GOOGLE_CREDENTIALS=new Vr("google-credentials-uid"),Vr.FIRST_PARTY=new Vr("first-party-uid"),Vr.MOCK_USER=new Vr("mock-user");let qr="9.15.0";const Br=new F("@firebase/firestore");function jr(){return Br.logLevel}function $r(e,...t){if(Br.logLevel<=O.DEBUG){const n=t.map(Kr);Br.debug(`Firestore (${qr}): ${e}`,...n)}}function Hr(e,...t){if(Br.logLevel<=O.ERROR){const n=t.map(Kr);Br.error(`Firestore (${qr}): ${e}`,...n)}}function zr(e,...t){if(Br.logLevel<=O.WARN){const n=t.map(Kr);Br.warn(`Firestore (${qr}): ${e}`,...n)}}function Kr(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Gr(e="Unexpected state"){const t=`FIRESTORE (${qr}) INTERNAL ASSERTION FAILED: `+e;throw Hr(t),new Error(t)}function Wr(e,t){e||Gr()}function Qr(e,t){return e}const Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jr extends g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Yr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Zr{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Vr.UNAUTHENTICATED)))}shutdown(){}}class to{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class no{constructor(e){this.t=e,this.currentUser=Vr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const s=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Yr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Yr,e.enqueueRetryable((()=>s(this.currentUser)))};const r=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await s(this.currentUser)}))},o=e=>{$r("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):($r("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Yr)}}),0),r()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?($r("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Wr("string"==typeof t.accessToken),new Zr(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Wr(null===e||"string"==typeof e),new Vr(e)}}class so{constructor(e,t,n,s){this.h=e,this.l=t,this.m=n,this.g=s,this.type="FirstParty",this.user=Vr.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Wr(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class io{constructor(e,t,n,s){this.h=e,this.l=t,this.m=n,this.g=s}getToken(){return Promise.resolve(new so(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable((()=>t(Vr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ro{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oo{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const n=e=>{null!=e.error&&$r("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.A;return this.A=e.token,$r("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const s=e=>{$r("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.T.onInit((e=>s(e))),setTimeout((()=>{if(!this.appCheck){const e=this.T.getImmediate({optional:!0});e?s(e):$r("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Wr("string"==typeof e.token),this.A=e.token,new ro(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ao(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class co{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=ao(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<t&&(n+=e.charAt(s[i]%e.length))}return n}}function uo(e,t){return e<t?-1:e>t?1:0}function lo(e,t,n){return e.length===t.length&&e.every(((e,s)=>n(e,t[s])))}class ho{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ho.fromMillis(Date.now())}static fromDate(e){return ho.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ho(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?uo(this.nanoseconds,e.nanoseconds):uo(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fo{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fo(e)}static min(){return new fo(new ho(0,0))}static max(){return new fo(new ho(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class po{constructor(e,t,n){void 0===t?t=0:t>e.length&&Gr(),void 0===n?n=e.length-t:n>e.length-t&&Gr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===po.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof po?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const n=e.get(s),i=t.get(s);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class go extends po{construct(e,t,n){return new go(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new go(t)}static emptyPath(){return new go([])}}const mo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yo extends po{construct(e,t,n){return new yo(e,t,n)}static isValidIdentifier(e){return mo.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yo.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new yo(["__name__"])}static fromServerFormat(e){const t=[];let n="",s=0;const i=()=>{if(0===n.length)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let r=!1;for(;s<e.length;){const t=e[s];if("\\"===t){if(s+1===e.length)throw new Jr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[s+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Jr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,s+=2}else"`"===t?(r=!r,s++):"."!==t||r?(n+=t,s++):(i(),s++)}if(i(),r)throw new Jr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yo(t)}static emptyPath(){return new yo([])}}class vo{constructor(e){this.path=e}static fromPath(e){return new vo(go.fromString(e))}static fromName(e){return new vo(go.fromString(e).popFirst(5))}static empty(){return new vo(go.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===go.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return go.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vo(new go(e.slice()))}}function wo(e){return new _o(e.readTime,e.key,-1)}class _o{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new _o(fo.min(),vo.empty(),-1)}static max(){return new _o(fo.max(),vo.empty(),-1)}}function bo(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=vo.comparator(e.documentKey,t.documentKey),0!==n?n:uo(e.largestBatchId,t.largestBatchId))}class To{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Io(e){if(e.code!==Xr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;$r("LocalStore","Unexpectedly lost primary lease")}class Eo{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Eo(((n,s)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,s)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Eo?t:Eo.resolve(t)}catch(e){return Eo.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Eo.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Eo.reject(t)}static resolve(e){return new Eo(((t,n)=>{t(e)}))}static reject(e){return new Eo(((t,n)=>{n(e)}))}static waitFor(e){return new Eo(((t,n)=>{let s=0,i=0,r=!1;e.forEach((e=>{++s,e.next((()=>{++i,r&&i===s&&t()}),(e=>n(e)))})),r=!0,i===s&&t()}))}static or(e){let t=Eo.resolve(!1);for(const n of e)t=t.next((e=>e?Eo.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,s)=>{n.push(t.call(this,e,s))})),this.waitFor(n)}static mapArray(e,t){return new Eo(((n,s)=>{const i=e.length,r=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{r[c]=e,++o,o===i&&n(r)}),(e=>s(e)))}}))}static doWhile(e,t){return new Eo(((n,s)=>{const i=()=>{!0===e()?t().next((()=>{i()}),s):n()};i()}))}}function ko(e){return"IndexedDbTransactionError"===e.name}class So{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ut(e),this.ct=e=>t.writeSequenceNumber(e))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}So.at=-1;class Co{constructor(e,t,n,s,i,r,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Ao{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ao("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ao&&e.projectId===this.projectId&&e.database===this.database}}function Ro(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Do(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function No(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Oo(e){return null==e}function Lo(e){return 0===e&&1/e==-1/0}class xo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new xo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new xo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return uo(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xo.EMPTY_BYTE_STRING=new xo("");const Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mo(e){if(Wr(!!e),"string"==typeof e){let t=0;const n=Po.exec(e);if(Wr(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const s=new Date(e);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:Uo(e.seconds),nanos:Uo(e.nanos)}}function Uo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Fo(e){return"string"==typeof e?xo.fromBase64String(e):xo.fromUint8Array(e)}function Vo(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function qo(e){const t=e.mapValue.fields.__previous_value__;return Vo(t)?qo(t):t}function Bo(e){const t=Mo(e.mapValue.fields.__local_write_time__.timestampValue);return new ho(t.seconds,t.nanos)}const jo={fields:{__type__:{stringValue:"__max__"}}};function $o(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Vo(e)?4:sa(e)?9007199254740991:10:Gr()}function Ho(e,t){if(e===t)return!0;const n=$o(e);if(n!==$o(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Bo(e).isEqual(Bo(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Mo(e.timestampValue),s=Mo(t.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Fo(e.bytesValue).isEqual(Fo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Uo(e.geoPointValue.latitude)===Uo(t.geoPointValue.latitude)&&Uo(e.geoPointValue.longitude)===Uo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Uo(e.integerValue)===Uo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Uo(e.doubleValue),s=Uo(t.doubleValue);return n===s?Lo(n)===Lo(s):isNaN(n)&&isNaN(s)}return!1}(e,t);case 9:return lo(e.arrayValue.values||[],t.arrayValue.values||[],Ho);case 10:return function(e,t){const n=e.mapValue.fields||{},s=t.mapValue.fields||{};if(Ro(n)!==Ro(s))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===s[e]||!Ho(n[e],s[e])))return!1;return!0}(e,t);default:return Gr()}}function zo(e,t){return void 0!==(e.values||[]).find((e=>Ho(e,t)))}function Ko(e,t){if(e===t)return 0;const n=$o(e),s=$o(t);if(n!==s)return uo(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return uo(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Uo(e.integerValue||e.doubleValue),s=Uo(t.integerValue||t.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(e,t);case 3:return Go(e.timestampValue,t.timestampValue);case 4:return Go(Bo(e),Bo(t));case 5:return uo(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Fo(e),s=Fo(t);return n.compareTo(s)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),s=t.split("/");for(let e=0;e<n.length&&e<s.length;e++){const t=uo(n[e],s[e]);if(0!==t)return t}return uo(n.length,s.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=uo(Uo(e.latitude),Uo(t.latitude));return 0!==n?n:uo(Uo(e.longitude),Uo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],s=t.values||[];for(let e=0;e<n.length&&e<s.length;++e){const t=Ko(n[e],s[e]);if(t)return t}return uo(n.length,s.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===jo&&t===jo)return 0;if(e===jo)return 1;if(t===jo)return-1;const n=e.fields||{},s=Object.keys(n),i=t.fields||{},r=Object.keys(i);s.sort(),r.sort();for(let e=0;e<s.length&&e<r.length;++e){const t=uo(s[e],r[e]);if(0!==t)return t;const o=Ko(n[s[e]],i[r[e]]);if(0!==o)return o}return uo(s.length,r.length)}(e.mapValue,t.mapValue);default:throw Gr()}}function Go(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return uo(e,t);const n=Mo(e),s=Mo(t),i=uo(n.seconds,s.seconds);return 0!==i?i:uo(n.nanos,s.nanos)}function Wo(e){return Qo(e)}function Qo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Mo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Fo(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,vo.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const s of e.values||[])n?n=!1:t+=",",t+=Qo(s);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",s=!0;for(const i of t)s?s=!1:n+=",",n+=`${i}:${Qo(e.fields[i])}`;return n+"}"}(e.mapValue):Gr();var t,n}function Xo(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Jo(e){return!!e&&"integerValue"in e}function Yo(e){return!!e&&"arrayValue"in e}function Zo(e){return!!e&&"nullValue"in e}function ea(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ta(e){return!!e&&"mapValue"in e}function na(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Do(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=na(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=na(e.arrayValue.values[n]);return t}return Object.assign({},e)}function sa(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ia{constructor(e,t){this.position=e,this.inclusive=t}}function ra(e,t,n){let s=0;for(let i=0;i<e.position.length;i++){const r=t[i],o=e.position[i];if(s=r.field.isKeyField()?vo.comparator(vo.fromName(o.referenceValue),n.key):Ko(o,n.data.field(r.field)),"desc"===r.dir&&(s*=-1),0!==s)break}return s}function oa(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ho(e.position[n],t.position[n]))return!1;return!0}class aa{}class ca extends aa{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ga(e,t,n):"array-contains"===t?new wa(e,n):"in"===t?new _a(e,n):"not-in"===t?new ba(e,n):"array-contains-any"===t?new Ta(e,n):new ca(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new ma(e,n):new ya(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Ko(t,this.value)):null!==t&&$o(this.value)===$o(t)&&this.matchesComparison(Ko(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Gr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class ua extends aa{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new ua(e,t)}matches(e){return la(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt((e=>e.isInequality()));return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function la(e){return"and"===e.op}function ha(e){return function(e){for(const t of e.filters)if(t instanceof ua)return!1;return!0}(e)&&la(e)}function da(e){if(e instanceof ca)return e.field.canonicalString()+e.op.toString()+Wo(e.value);{const t=e.filters.map((e=>da(e))).join(",");return`${e.op}(${t})`}}function fa(e,t){return e instanceof ca?function(e,t){return t instanceof ca&&e.op===t.op&&e.field.isEqual(t.field)&&Ho(e.value,t.value)}(e,t):e instanceof ua?function(e,t){return t instanceof ua&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,s)=>e&&fa(n,t.filters[s])),!0)}(e,t):void Gr()}function pa(e){return e instanceof ca?function(e){return`${e.field.canonicalString()} ${e.op} ${Wo(e.value)}`}(e):e instanceof ua?function(e){return e.op.toString()+" {"+e.getFilters().map(pa).join(" ,")+"}"}(e):"Filter"}class ga extends ca{constructor(e,t,n){super(e,t,n),this.key=vo.fromName(n.referenceValue)}matches(e){const t=vo.comparator(e.key,this.key);return this.matchesComparison(t)}}class ma extends ca{constructor(e,t){super(e,"in",t),this.keys=va(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ya extends ca{constructor(e,t){super(e,"not-in",t),this.keys=va(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function va(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>vo.fromName(e.referenceValue)))}class wa extends ca{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yo(t)&&zo(t.arrayValue,this.value)}}class _a extends ca{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&zo(this.value.arrayValue,t)}}class ba extends ca{constructor(e,t){super(e,"not-in",t)}matches(e){if(zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!zo(this.value.arrayValue,t)}}class Ta extends ca{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yo(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>zo(this.value.arrayValue,e)))}}class Ia{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ea(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ka{constructor(e,t){this.comparator=e,this.root=t||Ca.EMPTY}insert(e,t){return new ka(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ca.BLACK,null,null))}remove(e){return new ka(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ca.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(0===s)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sa(this.root,e,this.comparator,!0)}}class Sa{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ca{constructor(e,t,n,s,i){this.key=e,this.value=t,this.color=null!=n?n:Ca.RED,this.left=null!=s?s:Ca.EMPTY,this.right=null!=i?i:Ca.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,i){return new Ca(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,n),null):0===i?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ca.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return Ca.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ca.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ca.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gr();if(this.right.isRed())throw Gr();const e=this.left.check();if(e!==this.right.check())throw Gr();return e+(this.isRed()?0:1)}}Ca.EMPTY=null,Ca.RED=!0,Ca.BLACK=!1,Ca.EMPTY=new class{constructor(){this.size=0}get key(){throw Gr()}get value(){throw Gr()}get color(){throw Gr()}get left(){throw Gr()}get right(){throw Gr()}copy(e,t,n,s,i){return this}insert(e,t,n){return new Ca(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Aa{constructor(e){this.comparator=e,this.data=new ka(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ra(this.data.getIterator())}getIteratorFrom(e){return new Ra(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Aa))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(e,s))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Aa(this.comparator);return t.data=e,t}}class Ra{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Da{constructor(e){this.fields=e,e.sort(yo.comparator)}static empty(){return new Da([])}unionWith(e){let t=new Aa(yo.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Da(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Na{constructor(e){this.value=e}static empty(){return new Na({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ta(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=na(t)}setAll(e){let t=yo.emptyPath(),n={},s=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,s),n={},s=[],t=i.popLast()}e?n[i.lastSegment()]=na(e):s.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,s)}delete(e){const t=this.field(e.popLast());ta(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ho(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];ta(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){Do(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Na(na(this.value))}}function Oa(e){const t=[];return Do(e.fields,((e,n)=>{const s=new yo([e]);if(ta(n)){const e=Oa(n.mapValue).fields;if(0===e.length)t.push(s);else for(const n of e)t.push(s.child(n))}else t.push(s)})),new Da(t)}class La{constructor(e,t,n,s,i,r,o){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=i,this.data=r,this.documentState=o}static newInvalidDocument(e){return new La(e,0,fo.min(),fo.min(),fo.min(),Na.empty(),0)}static newFoundDocument(e,t,n,s){return new La(e,1,t,fo.min(),n,s,0)}static newNoDocument(e,t){return new La(e,2,t,fo.min(),fo.min(),Na.empty(),0)}static newUnknownDocument(e,t){return new La(e,3,t,fo.min(),fo.min(),Na.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fo.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Na.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Na.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof La&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new La(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xa{constructor(e,t=null,n=[],s=[],i=null,r=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=r,this.endAt=o,this.ft=null}}function Pa(e,t=null,n=[],s=[],i=null,r=null,o=null){return new xa(e,t,n,s,i,r,o)}function Ma(e){const t=Qr(e);if(null===t.ft){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>da(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Oo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Wo(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Wo(e))).join(",")),t.ft=e}return t.ft}function Ua(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ea(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!fa(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!oa(e.startAt,t.startAt)&&oa(e.endAt,t.endAt)}function Fa(e){return vo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Va{constructor(e,t=null,n=[],s=[],i=null,r="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=r,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function qa(e){return new Va(e)}function Ba(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ja(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function $a(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function Ha(e){return null!==e.collectionGroup}function za(e){const t=Qr(e);if(null===t.dt){t.dt=[];const e=$a(t),n=ja(t);if(null!==e&&null===n)e.isKeyField()||t.dt.push(new Ia(e)),t.dt.push(new Ia(yo.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.dt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new Ia(yo.keyField(),e))}}}return t.dt}function Ka(e){const t=Qr(e);if(!t._t)if("F"===t.limitType)t._t=Pa(t.path,t.collectionGroup,za(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of za(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Ia(n.field,t))}const n=t.endAt?new ia(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ia(t.startAt.position,t.startAt.inclusive):null;t._t=Pa(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}return t._t}function Ga(e,t){t.getFirstInequalityField(),$a(e);const n=e.filters.concat([t]);return new Va(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Wa(e,t,n){return new Va(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Qa(e,t){return Ua(Ka(e),Ka(t))&&e.limitType===t.limitType}function Xa(e){return`${Ma(Ka(e))}|lt:${e.limitType}`}function Ja(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>pa(e))).join(", ")}]`),Oo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Wo(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Wo(e))).join(",")),`Target(${t})`}(Ka(e))}; limitType=${e.limitType})`}function Ya(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):vo.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of za(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const s=ra(e,t,n);return e.inclusive?s<=0:s<0}(e.startAt,za(e),t)||e.endAt&&!function(e,t,n){const s=ra(e,t,n);return e.inclusive?s>=0:s>0}(e.endAt,za(e),t))}(e,t)}function Za(e){return(t,n)=>{let s=!1;for(const i of za(e)){const e=ec(i,t,n);if(0!==e)return e;s=s||i.field.isKeyField()}return 0}}function ec(e,t,n){const s=e.field.isKeyField()?vo.comparator(t.key,n.key):function(e,t,n){const s=t.data.field(e),i=n.data.field(e);return null!==s&&null!==i?Ko(s,i):Gr()}(e.field,t,n);switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return Gr()}}function tc(e,t){if(e.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lo(t)?"-0":t}}function nc(e){return{integerValue:""+e}}function sc(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Lo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?nc(t):tc(e,t)}class ic{constructor(){this._=void 0}}function rc(e,t,n){return e instanceof cc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof uc?lc(e,t):e instanceof hc?dc(e,t):function(e,t){const n=ac(e,t),s=pc(n)+pc(e.gt);return Jo(n)&&Jo(e.gt)?nc(s):tc(e.yt,s)}(e,t)}function oc(e,t,n){return e instanceof uc?lc(e,t):e instanceof hc?dc(e,t):n}function ac(e,t){return e instanceof fc?Jo(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class cc extends ic{}class uc extends ic{constructor(e){super(),this.elements=e}}function lc(e,t){const n=gc(t);for(const t of e.elements)n.some((e=>Ho(e,t)))||n.push(t);return{arrayValue:{values:n}}}class hc extends ic{constructor(e){super(),this.elements=e}}function dc(e,t){let n=gc(t);for(const t of e.elements)n=n.filter((e=>!Ho(e,t)));return{arrayValue:{values:n}}}class fc extends ic{constructor(e,t){super(),this.yt=e,this.gt=t}}function pc(e){return Uo(e.integerValue||e.doubleValue)}function gc(e){return Yo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class mc{constructor(e,t){this.field=e,this.transform=t}}class yc{constructor(e,t){this.version=e,this.transformResults=t}}class vc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vc}static exists(e){return new vc(void 0,e)}static updateTime(e){return new vc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class _c{}function bc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Nc(e.key,vc.none()):new Sc(e.key,e.data,vc.none());{const n=e.data,s=Na.empty();let i=new Aa(yo.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?s.delete(e):s.set(e,t),i=i.add(e)}return new Cc(e.key,s,new Da(i.toArray()),vc.none())}}function Tc(e,t,n){e instanceof Sc?function(e,t,n){const s=e.value.clone(),i=Rc(e.fieldTransforms,t,n.transformResults);s.setAll(i),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):e instanceof Cc?function(e,t,n){if(!wc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const s=Rc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ac(e)),i.setAll(s),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ic(e,t,n,s){return e instanceof Sc?function(e,t,n,s){if(!wc(e.precondition,t))return n;const i=e.value.clone(),r=Dc(e.fieldTransforms,s,t);return i.setAll(r),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,s):e instanceof Cc?function(e,t,n,s){if(!wc(e.precondition,t))return n;const i=Dc(e.fieldTransforms,s,t),r=t.data;return r.setAll(Ac(e)),r.setAll(i),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,s):function(e,t,n){return wc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ec(e,t){let n=null;for(const s of e.fieldTransforms){const e=t.data.field(s.field),i=ac(s.transform,e||null);null!=i&&(null===n&&(n=Na.empty()),n.set(s.field,i))}return n||null}function kc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&lo(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof uc&&t instanceof uc||e instanceof hc&&t instanceof hc?lo(e.elements,t.elements,Ho):e instanceof fc&&t instanceof fc?Ho(e.gt,t.gt):e instanceof cc&&t instanceof cc}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Sc extends _c{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Cc extends _c{constructor(e,t,n,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ac(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=e.data.field(n);t.set(n,s)}})),t}function Rc(e,t,n){const s=new Map;Wr(e.length===n.length);for(let i=0;i<n.length;i++){const r=e[i],o=r.transform,a=t.data.field(r.field);s.set(r.field,oc(o,a,n[i]))}return s}function Dc(e,t,n){const s=new Map;for(const i of e){const e=i.transform,r=n.data.field(i.field);s.set(i.field,rc(e,r,t))}return s}class Nc extends _c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Oc extends _c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Lc{constructor(e){this.count=e}}var xc,Pc;function Mc(e){if(void 0===e)return Hr("GRPC error has no .code"),Xr.UNKNOWN;switch(e){case xc.OK:return Xr.OK;case xc.CANCELLED:return Xr.CANCELLED;case xc.UNKNOWN:return Xr.UNKNOWN;case xc.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case xc.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case xc.INTERNAL:return Xr.INTERNAL;case xc.UNAVAILABLE:return Xr.UNAVAILABLE;case xc.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case xc.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case xc.NOT_FOUND:return Xr.NOT_FOUND;case xc.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case xc.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case xc.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case xc.ABORTED:return Xr.ABORTED;case xc.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case xc.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case xc.DATA_LOSS:return Xr.DATA_LOSS;default:return Gr()}}(Pc=xc||(xc={}))[Pc.OK=0]="OK",Pc[Pc.CANCELLED=1]="CANCELLED",Pc[Pc.UNKNOWN=2]="UNKNOWN",Pc[Pc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pc[Pc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pc[Pc.NOT_FOUND=5]="NOT_FOUND",Pc[Pc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pc[Pc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pc[Pc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pc[Pc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pc[Pc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pc[Pc.ABORTED=10]="ABORTED",Pc[Pc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pc[Pc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pc[Pc.INTERNAL=13]="INTERNAL",Pc[Pc.UNAVAILABLE=14]="UNAVAILABLE",Pc[Pc.DATA_LOSS=15]="DATA_LOSS";class Uc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,s]of n)if(this.equalsFn(t,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(void 0===s)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<s.length;n++)if(this.equalsFn(s[n][0],e))return void(s[n]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return 1===n.length?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Do(this.inner,((t,n)=>{for(const[t,s]of n)e(t,s)}))}isEmpty(){return No(this.inner)}size(){return this.innerSize}}const Fc=new ka(vo.comparator);function Vc(){return Fc}const qc=new ka(vo.comparator);function Bc(...e){let t=qc;for(const n of e)t=t.insert(n.key,n);return t}function jc(e){let t=qc;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function $c(){return zc()}function Hc(){return zc()}function zc(){return new Uc((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Kc=new ka(vo.comparator),Gc=new Aa(vo.comparator);function Wc(...e){let t=Gc;for(const n of e)t=t.add(n);return t}const Qc=new Aa(uo);function Xc(){return Qc}class Jc{constructor(e,t,n,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,Yc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Jc(fo.min(),s,Xc(),Vc(),Wc())}}class Yc{constructor(e,t,n,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Yc(n,t,Wc(),Wc(),Wc())}}class Zc{constructor(e,t,n,s){this.It=e,this.removedTargetIds=t,this.key=n,this.Tt=s}}class eu{constructor(e,t){this.targetId=e,this.Et=t}}class tu{constructor(e,t,n=xo.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class nu{constructor(){this.At=0,this.Rt=ru(),this.bt=xo.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=Wc(),t=Wc(),n=Wc();return this.Rt.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Gr()}})),new Yc(this.bt,this.Pt,e,t,n)}xt(){this.vt=!1,this.Rt=ru()}Nt(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class su{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=Vc(),this.qt=iu(),this.Ut=new Aa(uo)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}jt(e){this.forEachTarget(e,(t=>{const n=this.Wt(t);switch(e.state){case 0:this.zt(t)&&n.Dt(e.resumeToken);break;case 1:n.Mt(),n.Vt||n.xt(),n.Dt(e.resumeToken);break;case 2:n.Mt(),n.Vt||this.removeTarget(t);break;case 3:this.zt(t)&&(n.Ft(),n.Dt(e.resumeToken));break;case 4:this.zt(t)&&(this.Ht(t),n.Dt(e.resumeToken));break;default:Gr()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach(((e,n)=>{this.zt(n)&&t(n)}))}Jt(e){const t=e.targetId,n=e.Et.count,s=this.Yt(t);if(s){const e=s.target;if(Fa(e))if(0===n){const n=new vo(e.path);this.Qt(t,n,La.newNoDocument(n,fo.min()))}else Wr(1===n);else this.Xt(t)!==n&&(this.Ht(t),this.Ut=this.Ut.add(t))}}Zt(e){const t=new Map;this.Bt.forEach(((n,s)=>{const i=this.Yt(s);if(i){if(n.current&&Fa(i.target)){const t=new vo(i.target.path);null!==this.Lt.get(t)||this.te(s,t)||this.Qt(s,t,La.newNoDocument(t,e))}n.St&&(t.set(s,n.Ct()),n.xt())}}));let n=Wc();this.qt.forEach(((e,t)=>{let s=!0;t.forEachWhile((e=>{const t=this.Yt(e);return!t||2===t.purpose||(s=!1,!1)})),s&&(n=n.add(e))})),this.Lt.forEach(((t,n)=>n.setReadTime(e)));const s=new Jc(e,t,this.Ut,this.Lt,n);return this.Lt=Vc(),this.qt=iu(),this.Ut=new Aa(uo),s}Gt(e,t){if(!this.zt(e))return;const n=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,n),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,n){if(!this.zt(e))return;const s=this.Wt(e);this.te(e,t)?s.Nt(t,1):s.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),n&&(this.Lt=this.Lt.insert(t,n))}removeTarget(e){this.Bt.delete(e)}Xt(e){const t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let t=this.Bt.get(e);return t||(t=new nu,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new Aa(uo),this.qt=this.qt.insert(e,t)),t}zt(e){const t=null!==this.Yt(e);return t||$r("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new nu),this.$t.getRemoteKeysForTarget(e).forEach((t=>{this.Qt(e,t,null)}))}te(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}function iu(){return new ka(vo.comparator)}function ru(){return new ka(vo.comparator)}const ou={asc:"ASCENDING",desc:"DESCENDING"},au={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cu={and:"AND",or:"OR"};class uu{constructor(e,t){this.databaseId=e,this.wt=t}}function lu(e,t){return e.wt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function hu(e,t){return e.wt?t.toBase64():t.toUint8Array()}function du(e,t){return lu(e,t.toTimestamp())}function fu(e){return Wr(!!e),fo.fromTimestamp(function(e){const t=Mo(e);return new ho(t.seconds,t.nanos)}(e))}function pu(e,t){return function(e){return new go(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function gu(e){const t=go.fromString(e);return Wr(Lu(t)),t}function mu(e,t){return pu(e.databaseId,t.path)}function yu(e,t){const n=gu(t);if(n.get(1)!==e.databaseId.projectId)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new vo(_u(n))}function vu(e,t){return pu(e.databaseId,t)}function wu(e){return new go(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function _u(e){return Wr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function bu(e,t,n){return{name:mu(e,t),fields:n.value.mapValue.fields}}function Tu(e,t){return{documents:[vu(e,t.path)]}}function Iu(e,t){const n={structuredQuery:{}},s=t.path;null!==t.collectionGroup?(n.parent=vu(e,s),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=vu(e,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const i=function(e){if(0!==e.length)return Nu(ua.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const r=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ru(e.field),direction:Su(e.dir)}}(e)))}(t.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(e,t){return e.wt||Oo(t)?t:{value:t}}(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Eu(e){let t=function(e){const t=gu(e);return 4===t.length?go.emptyPath():_u(t)}(e.parent);const n=e.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){Wr(1===s);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let r=[];n.where&&(r=function(e){const t=ku(e);return t instanceof ua&&ha(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Ia(Du(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Oo(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ia(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new ia(n,t)}(n.endAt)),function(e,t,n,s,i,r,o,a){return new Va(e,t,n,s,i,r,o,a)}(t,i,o,r,a,"F",c,u)}function ku(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Du(e.unaryFilter.field);return ca.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Du(e.unaryFilter.field);return ca.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Du(e.unaryFilter.field);return ca.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Du(e.unaryFilter.field);return ca.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Gr()}}(e):void 0!==e.fieldFilter?function(e){return ca.create(Du(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Gr()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return ua.create(e.compositeFilter.filters.map((e=>ku(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Gr()}}(e.compositeFilter.op))}(e):Gr()}function Su(e){return ou[e]}function Cu(e){return au[e]}function Au(e){return cu[e]}function Ru(e){return{fieldPath:e.canonicalString()}}function Du(e){return yo.fromServerFormat(e.fieldPath)}function Nu(e){return e instanceof ca?function(e){if("=="===e.op){if(ea(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NAN"}};if(Zo(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ea(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NOT_NAN"}};if(Zo(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ru(e.field),op:Cu(e.op),value:e.value}}}(e):e instanceof ua?function(e){const t=e.getFilters().map((e=>Nu(e)));return 1===t.length?t[0]:{compositeFilter:{op:Au(e.op),filters:t}}}(e):Gr()}function Ou(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Lu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class xu{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const s=this.mutations[t];s.key.isEqual(e.key)&&Tc(s,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ic(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ic(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Hc();return this.mutations.forEach((s=>{const i=e.get(s.key),r=i.overlayedDocument;let o=this.applyToLocalView(r,i.mutatedFields);o=t.has(s.key)?null:o;const a=bc(r,o);null!==a&&n.set(s.key,a),r.isValidDocument()||r.convertToNoDocument(fo.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Wc())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,((e,t)=>kc(e,t)))&&lo(this.baseMutations,e.baseMutations,((e,t)=>kc(e,t)))}}class Pu{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){Wr(e.mutations.length===n.length);let s=Kc;const i=e.mutations;for(let e=0;e<i.length;e++)s=s.insert(i[e].key,n[e].version);return new Pu(e,t,n,s)}}class Mu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Uu{constructor(e,t,n,s,i=fo.min(),r=fo.min(),o=xo.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o}withSequenceNumber(e){return new Uu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Uu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Uu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Fu{constructor(e){this.ie=e}}function Vu(e){const t=Eu({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Wa(t,t.limit,"L"):t}class qu{constructor(){}ue(e,t){this.ce(e,t),t.ae()}ce(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(Uo(e.integerValue));else if("doubleValue"in e){const n=Uo(e.doubleValue);isNaN(n)?this.he(t,13):(this.he(t,15),Lo(n)?t.le(0):t.le(n))}else if("timestampValue"in e){const n=e.timestampValue;this.he(t,20),"string"==typeof n?t.fe(n):(t.fe(`${n.seconds||""}`),t.le(n.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(Fo(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.he(t,45),t.le(n.latitude||0),t.le(n.longitude||0)}else"mapValue"in e?sa(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Gr()}de(e,t){this.he(t,25),this.pe(e,t)}pe(e,t){t.fe(e)}ge(e,t){const n=e.fields||{};this.he(t,55);for(const e of Object.keys(n))this.de(e,t),this.ce(n[e],t)}ye(e,t){const n=e.values||[];this.he(t,50);for(const e of n)this.ce(e,t)}me(e,t){this.he(t,37),vo.fromName(e).path.forEach((e=>{this.he(t,60),this.pe(e,t)}))}he(e,t){e.le(t)}_e(e){e.le(2)}}qu.Ie=new qu;class Bu{constructor(){this.Je=new ju}addToCollectionParentIndex(e,t){return this.Je.add(t),Eo.resolve()}getCollectionParents(e,t){return Eo.resolve(this.Je.getEntries(t))}addFieldIndex(e,t){return Eo.resolve()}deleteFieldIndex(e,t){return Eo.resolve()}getDocumentsMatchingTarget(e,t){return Eo.resolve(null)}getIndexType(e,t){return Eo.resolve(0)}getFieldIndexes(e,t){return Eo.resolve([])}getNextCollectionGroupToUpdate(e){return Eo.resolve(null)}getMinOffset(e,t){return Eo.resolve(_o.min())}getMinOffsetFromCollectionGroup(e,t){return Eo.resolve(_o.min())}updateCollectionGroup(e,t,n){return Eo.resolve()}updateIndexEntries(e,t){return Eo.resolve()}}class ju{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Aa(go.comparator),i=!s.has(n);return this.index[t]=s.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Aa(go.comparator)).toArray()}}new Uint8Array(0);class $u{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new $u(e,$u.DEFAULT_COLLECTION_PERCENTILE,$u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}$u.DEFAULT_COLLECTION_PERCENTILE=10,$u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$u.DEFAULT=new $u(41943040,$u.DEFAULT_COLLECTION_PERCENTILE,$u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$u.DISABLED=new $u(-1,0,0);class Hu{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Hu(0)}static vn(){return new Hu(-1)}}class zu{constructor(){this.changes=new Uc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,La.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Eo.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ku{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Gu{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Ic(n.mutation,e,Da.empty(),ho.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Wc()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Wc()){const s=$c();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((e=>{let t=Bc();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=$c();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Wc())))}populateOverlays(e,t,n){const s=[];return n.forEach((e=>{t.has(e)||s.push(e)})),this.documentOverlayCache.getOverlays(e,s).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,s){let i=Vc();const r=zc(),o=zc();return t.forEach(((e,t)=>{const o=n.get(t.key);s.has(t.key)&&(void 0===o||o.mutation instanceof Cc)?i=i.insert(t.key,t):void 0!==o&&(r.set(t.key,o.mutation.getFieldMask()),Ic(o.mutation,t,o.mutation.getFieldMask(),ho.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>r.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Ku(t,null!==(n=r.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=zc();let s=new ka(((e,t)=>e-t)),i=Wc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const r=t.get(e);if(null===r)return;let o=n.get(e)||Da.empty();o=i.applyToLocalView(r,o),n.set(e,o);const a=(s.get(i.batchId)||Wc()).add(e);s=s.insert(i.batchId,a)}))})).next((()=>{const r=[],o=s.getReverseIterator();for(;o.hasNext();){const s=o.getNext(),a=s.key,c=s.value,u=Hc();c.forEach((e=>{if(!i.has(e)){const s=bc(t.get(e),n.get(e));null!==s&&u.set(e,s),i=i.add(e)}})),r.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Eo.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return vo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ha(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((i=>{const r=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-i.size):Eo.resolve($c());let o=-1,a=i;return r.next((t=>Eo.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Eo.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Wc()))).next((e=>({batchId:o,changes:jc(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new vo(t)).next((e=>{let t=Bc();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const s=t.collectionGroup;let i=Bc();return this.indexManager.getCollectionParents(e,s).next((r=>Eo.forEach(r,(r=>{const o=function(e,t){return new Va(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,r.child(s));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n){let s;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)))).next((e=>{e.forEach(((e,t)=>{const n=t.getKey();null===s.get(n)&&(s=s.insert(n,La.newInvalidDocument(n)))}));let n=Bc();return s.forEach(((s,i)=>{const r=e.get(s);void 0!==r&&Ic(r.mutation,i,Da.empty(),ho.now()),Ya(t,i)&&(n=n.insert(s,i))})),n}))}}class Wu{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return Eo.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:fu(n.createTime)}),Eo.resolve()}getNamedQuery(e,t){return Eo.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Vu(e.bundledQuery),readTime:fu(e.readTime)}}(t)),Eo.resolve()}}class Qu{constructor(){this.overlays=new ka(vo.comparator),this.es=new Map}getOverlay(e,t){return Eo.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$c();return Eo.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,s)=>{this.oe(e,t,s)})),Eo.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.es.get(n);return void 0!==s&&(s.forEach((e=>this.overlays=this.overlays.remove(e))),this.es.delete(n)),Eo.resolve()}getOverlaysForCollection(e,t,n){const s=$c(),i=t.length+1,r=new vo(t.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const e=o.getNext().value,r=e.getKey();if(!t.isPrefixOf(r.path))break;r.path.length===i&&e.largestBatchId>n&&s.set(e.getKey(),e)}return Eo.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let i=new ka(((e,t)=>e-t));const r=this.overlays.getIterator();for(;r.hasNext();){const e=r.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=$c(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=$c(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=s)););return Eo.resolve(o)}oe(e,t,n){const s=this.overlays.get(n.key);if(null!==s){const e=this.es.get(s.largestBatchId).delete(n.key);this.es.set(s.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Mu(t,n));let i=this.es.get(t);void 0===i&&(i=Wc(),this.es.set(t,i)),this.es.set(t,i.add(n.key))}}class Xu{constructor(){this.ns=new Aa(Ju.ss),this.rs=new Aa(Ju.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const n=new Ju(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.cs(new Ju(e,t))}hs(e,t){e.forEach((e=>this.removeReference(e,t)))}ls(e){const t=new vo(new go([])),n=new Ju(t,e),s=new Ju(t,e+1),i=[];return this.rs.forEachInRange([n,s],(e=>{this.cs(e),i.push(e.key)})),i}fs(){this.ns.forEach((e=>this.cs(e)))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new vo(new go([])),n=new Ju(t,e),s=new Ju(t,e+1);let i=Wc();return this.rs.forEachInRange([n,s],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Ju(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ju{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return vo.comparator(e.key,t.key)||uo(e._s,t._s)}static os(e,t){return uo(e._s,t._s)||vo.comparator(e.key,t.key)}}class Yu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new Aa(Ju.ss)}checkEmpty(e){return Eo.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,s){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new xu(i,t,n,s);this.mutationQueue.push(r);for(const t of s)this.gs=this.gs.add(new Ju(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Eo.resolve(r)}lookupMutationBatch(e,t){return Eo.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ps(n),i=s<0?0:s;return Eo.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Eo.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return Eo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ju(t,0),s=new Ju(t,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([n,s],(e=>{const t=this.ys(e._s);i.push(t)})),Eo.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Aa(uo);return t.forEach((e=>{const t=new Ju(e,0),s=new Ju(e,Number.POSITIVE_INFINITY);this.gs.forEachInRange([t,s],(e=>{n=n.add(e._s)}))})),Eo.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let i=n;vo.isDocumentKey(i)||(i=i.child(""));const r=new Ju(new vo(i),0);let o=new Aa(uo);return this.gs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===s&&(o=o.add(e._s)),!0)}),r),Eo.resolve(this.Is(o))}Is(e){const t=[];return e.forEach((e=>{const n=this.ys(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Wr(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Eo.forEach(t.mutations,(s=>{const i=new Ju(s.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.gs=n}))}An(e){}containsKey(e,t){const n=new Ju(t,0),s=this.gs.firstAfterOrEqual(n);return Eo.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Eo.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Zu{constructor(e){this.Es=e,this.docs=new ka(vo.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),i=s?s.size:0,r=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:r}),this.size+=r-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Eo.resolve(n?n.document.mutableCopy():La.newInvalidDocument(t))}getEntries(e,t){let n=Vc();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():La.newInvalidDocument(e))})),Eo.resolve(n)}getAllFromCollection(e,t,n){let s=Vc();const i=new vo(t.child("")),r=this.docs.getIteratorFrom(i);for(;r.hasNext();){const{key:e,value:{document:i}}=r.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||bo(wo(i),n)<=0||(s=s.insert(i.key,i.mutableCopy()))}return Eo.resolve(s)}getAllFromCollectionGroup(e,t,n,s){Gr()}As(e,t){return Eo.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new el(this)}getSize(e){return Eo.resolve(this.size)}}class el extends zu{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Yn.addEntry(e,s)):this.Yn.removeEntry(n)})),Eo.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class tl{constructor(e){this.persistence=e,this.Rs=new Uc((e=>Ma(e)),Ua),this.lastRemoteSnapshotVersion=fo.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Xu,this.targetCount=0,this.vs=Hu.Pn()}forEachTarget(e,t){return this.Rs.forEach(((e,n)=>t(n))),Eo.resolve()}getLastRemoteSnapshotVersion(e){return Eo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Eo.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),Eo.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Eo.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Hu(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,Eo.resolve()}updateTargetData(e,t){return this.Dn(t),Eo.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Eo.resolve()}removeTargets(e,t,n){let s=0;const i=[];return this.Rs.forEach(((r,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Rs.delete(r),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)})),Eo.waitFor(i).next((()=>s))}getTargetCount(e){return Eo.resolve(this.targetCount)}getTargetData(e,t){const n=this.Rs.get(t)||null;return Eo.resolve(n)}addMatchingKeys(e,t,n){return this.Ps.us(t,n),Eo.resolve()}removeMatchingKeys(e,t,n){this.Ps.hs(t,n);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((t=>{i.push(s.markPotentiallyOrphaned(e,t))})),Eo.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),Eo.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ps.ds(t);return Eo.resolve(n)}containsKey(e,t){return Eo.resolve(this.Ps.containsKey(t))}}class nl{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new So(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new tl(this),this.indexManager=new Bu,this.remoteDocumentCache=function(e){return new Zu(e)}((e=>this.referenceDelegate.xs(e))),this.yt=new Fu(t),this.Ns=new Wu(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Vs[e.toKey()];return n||(n=new Yu(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,n){$r("MemoryPersistence","Starting transaction:",e);const s=new sl(this.Ss.next());return this.referenceDelegate.ks(),n(s).next((e=>this.referenceDelegate.Os(s).next((()=>e)))).toPromise().then((e=>(s.raiseOnCommittedEvent(),e)))}Ms(e,t){return Eo.or(Object.values(this.Vs).map((n=>()=>n.containsKey(e,t))))}}class sl extends To{constructor(e){super(),this.currentSequenceNumber=e}}class il{constructor(e){this.persistence=e,this.Fs=new Xu,this.$s=null}static Bs(e){return new il(e)}get Ls(){if(this.$s)return this.$s;throw Gr()}addReference(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Eo.resolve()}removeReference(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Eo.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),Eo.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach((e=>this.Ls.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ls.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Eo.forEach(this.Ls,(n=>{const s=vo.fromPath(n);return this.qs(e,s).next((e=>{e||t.removeEntry(s,fo.min())}))})).next((()=>(this.$s=null,t.apply(e))))}updateLimboDocument(e,t){return this.qs(e,t).next((e=>{e?this.Ls.delete(t.toString()):this.Ls.add(t.toString())}))}xs(e){return 0}qs(e,t){return Eo.or([()=>Eo.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class rl{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Si=n,this.Di=s}static Ci(e,t){let n=Wc(),s=Wc();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:s=s.add(e.doc.key)}return new rl(e,t.fromCache,n,s)}}class ol{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,n,s){return this.ki(e,t).next((i=>i||this.Oi(e,t,s,n))).next((n=>n||this.Mi(e,t)))}ki(e,t){if(Ba(t))return Eo.resolve(null);let n=Ka(t);return this.indexManager.getIndexType(e,n).next((s=>0===s?null:(null!==t.limit&&1===s&&(t=Wa(t,null,"F"),n=Ka(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const i=Wc(...s);return this.Ni.getDocuments(e,i).next((s=>this.indexManager.getMinOffset(e,n).next((n=>{const r=this.Fi(t,s);return this.$i(t,r,i,n.readTime)?this.ki(e,Wa(t,null,"F")):this.Bi(e,r,t,n)}))))})))))}Oi(e,t,n,s){return Ba(t)||s.isEqual(fo.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((i=>{const r=this.Fi(t,i);return this.$i(t,r,n,s)?this.Mi(e,t):(jr()<=O.DEBUG&&$r("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ja(t)),this.Bi(e,r,t,function(e,t){const n=e.toTimestamp().seconds,s=e.toTimestamp().nanoseconds+1,i=fo.fromTimestamp(1e9===s?new ho(n+1,0):new ho(n,s));return new _o(i,vo.empty(),t)}(s,-1)))}))}Fi(e,t){let n=new Aa(Za(e));return t.forEach(((t,s)=>{Ya(e,s)&&(n=n.add(s))})),n}$i(e,t,n,s){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(e,t){return jr()<=O.DEBUG&&$r("QueryEngine","Using full collection scan to execute query:",Ja(t)),this.Ni.getDocumentsMatchingQuery(e,t,_o.min())}Bi(e,t,n,s){return this.Ni.getDocumentsMatchingQuery(e,n,s).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class al{constructor(e,t,n,s){this.persistence=e,this.Li=t,this.yt=s,this.qi=new ka(uo),this.Ui=new Uc((e=>Ma(e)),Ua),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(n)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gu(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.qi)))}}async function cl(e,t){const n=Qr(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n.mutationQueue.getAllMutationBatches(e).next((i=>(s=i,n.Qi(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],r=[];let o=Wc();for(const e of s){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ji:e,removedBatchIds:i,addedBatchIds:r})))}))}))}function ul(e){const t=Qr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Cs.getLastRemoteSnapshotVersion(e)))}function ll(e,t){const n=Qr(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}async function hl(e,t,n){const s=Qr(e),i=s.qi.get(t),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,(e=>s.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ko(e))throw e;$r("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}s.qi=s.qi.remove(t),s.Ui.delete(i.target)}function dl(e,t,n){const s=Qr(e);let i=fo.min(),r=Wc();return s.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const s=Qr(e),i=s.Ui.get(n);return void 0!==i?Eo.resolve(s.qi.get(i)):s.Cs.getTargetData(t,n)}(s,e,Ka(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,s.Cs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{r=e}))})).next((()=>s.Li.getDocumentsMatchingQuery(e,t,n?i:fo.min(),n?r:Wc()))).next((e=>(function(e,t,n){let s=e.Ki.get(t)||fo.min();n.forEach(((e,t)=>{t.readTime.compareTo(s)>0&&(s=t.readTime)})),e.Ki.set(t,s)}(s,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Hi:r})))))}class fl{constructor(){this.activeTargetIds=Xc()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pl{constructor(){this.Lr=new fl,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,t,n){this.qr[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new fl,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gl{Ur(e){}shutdown(){}}class ml{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){$r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){$r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const yl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vl{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class wl extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.oo=t+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,n,s,i){const r=this.ho(e,t);$r("RestConnection","Sending: ",r,n);const o={};return this.lo(o,s,i),this.fo(e,r,o,n).then((e=>($r("RestConnection","Received: ",e),e)),(t=>{throw zr("RestConnection",`${e} failed with error: `,t,"url: ",r,"request:",n),t}))}_o(e,t,n,s,i,r){return this.ao(e,t,n,s,i)}lo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+qr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}ho(e,t){const n=yl[e];return`${this.oo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,n,s){return new Promise(((i,r)=>{const o=new Ur;o.setWithCredentials(!0),o.listenOnce(Or.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case Nr.NO_ERROR:const t=o.getResponseJson();$r("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Nr.TIMEOUT:$r("Connection",'RPC "'+e+'" timed out'),r(new Jr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case Nr.HTTP_ERROR:const n=o.getStatus();if($r("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Xr).indexOf(t)>=0?t:Xr.UNKNOWN}(t.status);r(new Jr(e,t.message))}else r(new Jr(Xr.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Jr(Xr.UNAVAILABLE,"Connection failed."));break;default:Gr()}}finally{$r("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(s);o.send(t,"POST",a,n,15)}))}wo(e,t,n){const s=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Rr(),r=Dr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Pr({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const a=s.join("");$r("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let u=!1,l=!1;const h=new vl({Hr:e=>{l?$r("Connection","Not sending because WebChannel is closed:",e):(u||($r("Connection","Opening WebChannel transport."),c.open(),u=!0),$r("Connection","WebChannel sending:",e),c.send(e))},Jr:()=>c.close()}),d=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return d(c,Mr.EventType.OPEN,(()=>{l||$r("Connection","WebChannel transport opened.")})),d(c,Mr.EventType.CLOSE,(()=>{l||(l=!0,$r("Connection","WebChannel transport closed"),h.io())})),d(c,Mr.EventType.ERROR,(e=>{l||(l=!0,zr("Connection","WebChannel transport errored:",e),h.io(new Jr(Xr.UNAVAILABLE,"The operation could not be completed")))})),d(c,Mr.EventType.MESSAGE,(e=>{var t;if(!l){const n=e.data[0];Wr(!!n);const s=n,i=s.error||(null===(t=s[0])||void 0===t?void 0:t.error);if(i){$r("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=xc[e];if(void 0!==t)return Mc(t)}(e),n=i.message;void 0===t&&(t=Xr.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),l=!0,h.io(new Jr(t,n)),c.close()}else $r("Connection","WebChannel received:",n),h.ro(n)}})),d(r,Lr.STAT_EVENT,(e=>{e.stat===xr.PROXY?$r("Connection","Detected buffering proxy"):e.stat===xr.NOPROXY&&$r("Connection","Detected no buffering proxy")})),setTimeout((()=>{h.so()}),0),h}}function _l(){return"undefined"!=typeof document?document:null}function bl(e){return new uu(e,!0)}class Tl{constructor(e,t,n=1e3,s=1.5,i=6e4){this.Hs=e,this.timerId=t,this.mo=n,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),s=Math.max(0,t-n);s>0&&$r("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,(()=>(this.Eo=Date.now(),e()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Il{constructor(e,t,n,s,i,r,o,a){this.Hs=e,this.vo=n,this.Vo=s,this.connection=i,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Tl(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,t){this.Lo(),this.qo(),this.xo.cancel(),this.So++,4!==e?this.xo.reset():t&&t.code===Xr.RESOURCE_EXHAUSTED?(Hr(t.toString()),Hr("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):t&&t.code===Xr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Uo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(t)}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.So===t&&this.Go(e,n)}),(t=>{e((()=>{const e=new Jr(Xr.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Qo(e)}))}))}Go(e,t){const n=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((e=>{n((()=>this.Qo(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(e){return $r("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget((()=>this.So===e?t():($r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class El extends Il{constructor(e,t,n,s,i,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,r),this.yt=i}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const s=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Gr()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=function(e,t){return e.wt?(Wr(void 0===t||"string"==typeof t),xo.fromBase64String(t||"")):(Wr(void 0===t||t instanceof Uint8Array),xo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Xr.UNKNOWN:Mc(e.code);return new Jr(t,e.message||"")}(o);n=new tu(s,i,r,a||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const i=yu(e,s.document.name),r=fu(s.document.updateTime),o=s.document.createTime?fu(s.document.createTime):fo.min(),a=new Na({mapValue:{fields:s.document.fields}}),c=La.newFoundDocument(i,r,o,a),u=s.targetIds||[],l=s.removedTargetIds||[];n=new Zc(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const i=yu(e,s.document),r=s.readTime?fu(s.readTime):fo.min(),o=La.newNoDocument(i,r),a=s.removedTargetIds||[];n=new Zc([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const i=yu(e,s.document),r=s.removedTargetIds||[];n=new Zc([],r,i,null)}else{if(!("filter"in t))return Gr();{t.filter;const e=t.filter;e.targetId;const s=e.count||0,i=new Lc(s),r=e.targetId;n=new eu(r,i)}}return n}(this.yt,e),n=function(e){if(!("targetChange"in e))return fo.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?fo.min():t.readTime?fu(t.readTime):fo.min()}(e);return this.listener.Wo(t,n)}zo(e){const t={};t.database=wu(this.yt),t.addTarget=function(e,t){let n;const s=t.target;return n=Fa(s)?{documents:Tu(e,s)}:{query:Iu(e,s)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=hu(e,t.resumeToken):t.snapshotVersion.compareTo(fo.min())>0&&(n.readTime=lu(e,t.snapshotVersion.toTimestamp())),n}(this.yt,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Gr()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,e);n&&(t.labels=n),this.Bo(t)}Ho(e){const t={};t.database=wu(this.yt),t.removeTarget=e,this.Bo(t)}}class kl extends Il{constructor(e,t,n,s,i,r){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,r),this.yt=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(Wr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function(e,t){return e&&e.length>0?(Wr(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?fu(e.updateTime):fu(t);return n.isEqual(fo.min())&&(n=fu(t)),new yc(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=fu(e.commitTime);return this.listener.Zo(n,t)}return Wr(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=wu(this.yt),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof Sc)n={update:bu(e,t.key,t.value)};else if(t instanceof Nc)n={delete:mu(e,t.key)};else if(t instanceof Cc)n={update:bu(e,t.key,t.data),updateMask:Ou(t.fieldMask)};else{if(!(t instanceof Oc))return Gr();n={verify:mu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof cc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof uc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof hc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof fc)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Gr()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:du(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Gr()}(e,t.precondition)),n}(this.yt,e)))};this.Bo(t)}}class Sl extends class{}{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.yt=s,this.nu=!1}su(){if(this.nu)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.ao(e,t,n,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Jr(Xr.UNKNOWN,e.toString())}))}_o(e,t,n,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection._o(e,t,n,i,r,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Jr(Xr.UNKNOWN,e.toString())}))}terminate(){this.nu=!0}}class Cl{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Hr(t),this.ou=!1):$r("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Al{constructor(e,t,n,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.Ur((e=>{n.enqueueAndForget((async()=>{Ul(this)&&($r("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Qr(e);t._u.add(4),await Dl(t),t.gu.set("Unknown"),t._u.delete(4),await Rl(t)}(this))}))})),this.gu=new Cl(n,s)}}async function Rl(e){if(Ul(e))for(const t of e.wu)await t(!0)}async function Dl(e){for(const t of e.wu)await t(!1)}function Nl(e,t){const n=Qr(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Ml(n)?Pl(n):eh(n).ko()&&Ll(n,t))}function Ol(e,t){const n=Qr(e),s=eh(n);n.du.delete(t),s.ko()&&xl(n,t),0===n.du.size&&(s.ko()?s.Fo():Ul(n)&&n.gu.set("Unknown"))}function Ll(e,t){e.yu.Ot(t.targetId),eh(e).zo(t)}function xl(e,t){e.yu.Ot(t),eh(e).Ho(t)}function Pl(e){e.yu=new su({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ne:t=>e.du.get(t)||null}),eh(e).start(),e.gu.uu()}function Ml(e){return Ul(e)&&!eh(e).No()&&e.du.size>0}function Ul(e){return 0===Qr(e)._u.size}function Fl(e){e.yu=void 0}async function Vl(e){e.du.forEach(((t,n)=>{Ll(e,t)}))}async function ql(e,t){Fl(e),Ml(e)?(e.gu.hu(t),Pl(e)):e.gu.set("Unknown")}async function Bl(e,t,n){if(e.gu.set("Online"),t instanceof tu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const s of t.targetIds)e.du.has(s)&&(await e.remoteSyncer.rejectListen(s,n),e.du.delete(s),e.yu.removeTarget(s))}(e,t)}catch(n){$r("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await jl(e,n)}else if(t instanceof Zc?e.yu.Kt(t):t instanceof eu?e.yu.Jt(t):e.yu.jt(t),!n.isEqual(fo.min()))try{const t=await ul(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.yu.Zt(t);return n.targetChanges.forEach(((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.du.get(s);i&&e.du.set(s,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.du.get(t);if(!n)return;e.du.set(t,n.withResumeToken(xo.EMPTY_BYTE_STRING,n.snapshotVersion)),xl(e,t);const s=new Uu(n.target,t,1,n.sequenceNumber);Ll(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){$r("RemoteStore","Failed to raise snapshot:",t),await jl(e,t)}}async function jl(e,t,n){if(!ko(t))throw t;e._u.add(1),await Dl(e),e.gu.set("Offline"),n||(n=()=>ul(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{$r("RemoteStore","Retrying IndexedDB access"),await n(),e._u.delete(1),await Rl(e)}))}function $l(e,t){return t().catch((n=>jl(e,n,t)))}async function Hl(e){const t=Qr(e),n=th(t);let s=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;zl(t);)try{const e=await ll(t.localStore,s);if(null===e){0===t.fu.length&&n.Fo();break}s=e.batchId,Kl(t,e)}catch(e){await jl(t,e)}Gl(t)&&Wl(t)}function zl(e){return Ul(e)&&e.fu.length<10}function Kl(e,t){e.fu.push(t);const n=th(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function Gl(e){return Ul(e)&&!th(e).No()&&e.fu.length>0}function Wl(e){th(e).start()}async function Ql(e){th(e).eu()}async function Xl(e){const t=th(e);for(const n of e.fu)t.Xo(n.mutations)}async function Jl(e,t,n){const s=e.fu.shift(),i=Pu.from(s,t,n);await $l(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Hl(e)}async function Yl(e,t){t&&th(e).Yo&&await async function(e,t){if(function(e){switch(e){default:return Gr();case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return!1;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return!0}}(n=t.code)&&n!==Xr.ABORTED){const n=e.fu.shift();th(e).Mo(),await $l(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Hl(e)}var n}(e,t),Gl(e)&&Wl(e)}async function Zl(e,t){const n=Qr(e);n.asyncQueue.verifyOperationInProgress(),$r("RemoteStore","RemoteStore received new credentials");const s=Ul(n);n._u.add(3),await Dl(n),s&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n._u.delete(3),await Rl(n)}function eh(e){return e.pu||(e.pu=function(e,t,n){const s=Qr(e);return s.su(),new El(t,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,n)}(e.datastore,e.asyncQueue,{Yr:Vl.bind(null,e),Zr:ql.bind(null,e),Wo:Bl.bind(null,e)}),e.wu.push((async t=>{t?(e.pu.Mo(),Ml(e)?Pl(e):e.gu.set("Unknown")):(await e.pu.stop(),Fl(e))}))),e.pu}function th(e){return e.Iu||(e.Iu=function(e,t,n){const s=Qr(e);return s.su(),new kl(t,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,n)}(e.datastore,e.asyncQueue,{Yr:Ql.bind(null,e),Zr:Yl.bind(null,e),tu:Xl.bind(null,e),Zo:Jl.bind(null,e)}),e.wu.push((async t=>{t?(e.Iu.Mo(),await Hl(e)):(await e.Iu.stop(),e.fu.length>0&&($r("RemoteStore",`Stopping write stream with ${e.fu.length} pending writes`),e.fu=[]))}))),e.Iu}class nh{constructor(e,t,n,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Yr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,s,i){const r=Date.now()+n,o=new nh(e,t,r,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jr(Xr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sh(e,t){if(Hr("AsyncQueue",`${t}: ${e}`),ko(e))return new Jr(Xr.UNAVAILABLE,`${t}: ${e}`);throw e}class ih{constructor(e){this.comparator=e?(t,n)=>e(t,n)||vo.comparator(t.key,n.key):(e,t)=>vo.comparator(e.key,t.key),this.keyedMap=Bc(),this.sortedSet=new ka(this.comparator)}static emptySet(e){return new ih(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ih))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,s=n.getNext().key;if(!e.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ih;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class rh{constructor(){this.Tu=new ka(vo.comparator)}track(e){const t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Gr():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class oh{constructor(e,t,n,s,i,r,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,s,i){const r=[];return t.forEach((e=>{r.push({type:0,doc:e})})),new oh(e,t,ih.emptySet(t),r,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class ah{constructor(){this.Au=void 0,this.listeners=[]}}class ch{constructor(){this.queries=new Uc((e=>Xa(e)),Qa),this.onlineState="Unknown",this.Ru=new Set}}function uh(e,t){const n=Qr(e);let s=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Pu(e)&&(s=!0);i.Au=e}}s&&hh(n)}function lh(e,t,n){const s=Qr(e),i=s.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);s.queries.delete(t)}function hh(e){e.Ru.forEach((e=>{e.next()}))}class dh{constructor(e,t,n){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new oh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){if(e.docChanges.length>0)return!0;const t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}xu(e){e=oh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class fh{constructor(e){this.key=e}}class ph{constructor(e){this.key=e}}class gh{constructor(e,t){this.query=e,this.qu=t,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Wc(),this.mutatedKeys=Wc(),this.Gu=Za(e),this.Qu=new ih(this.Gu)}get ju(){return this.qu}Wu(e,t){const n=t?t.zu:new rh,s=t?t.Qu:this.Qu;let i=t?t.mutatedKeys:this.mutatedKeys,r=s,o=!1;const a="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,c="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((e,t)=>{const u=s.get(e),l=Ya(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Hu(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Gu(l,a)>0||c&&this.Gu(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(r=r.add(l),i=d?i.add(e):i.delete(e)):(r=r.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const e="F"===this.query.limitType?r.last():r.first();r=r.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Qu:r,zu:n,$i:o,mutatedKeys:i}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const s=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Eu();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gr()}};return n(e)-n(t)}(e.type,t.type)||this.Gu(e.doc,t.doc))),this.Ju(n);const r=t?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.Uu;return this.Uu=o,0!==i.length||a?{snapshot:new oh(this.query,e.Qu,s,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:r}:{Xu:r}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new rh,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach((e=>this.qu=this.qu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.qu=this.qu.delete(e))),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Wc(),this.Qu.forEach((e=>{this.Zu(e.key)&&(this.Ku=this.Ku.add(e.key))}));const t=[];return e.forEach((e=>{this.Ku.has(e)||t.push(new ph(e))})),this.Ku.forEach((n=>{e.has(n)||t.push(new fh(n))})),t}tc(e){this.qu=e.Hi,this.Ku=Wc();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return oh.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class mh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class yh{constructor(e){this.key=e,this.nc=!1}}class vh{constructor(e,t,n,s,i,r){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=r,this.sc={},this.ic=new Uc((e=>Xa(e)),Qa),this.rc=new Map,this.oc=new Set,this.uc=new ka(vo.comparator),this.cc=new Map,this.ac=new Xu,this.hc={},this.lc=new Map,this.fc=Hu.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function wh(e,t){const n=function(e){const t=Qr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=bh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ph.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ih.bind(null,t),t.sc.Wo=uh.bind(null,t.eventManager),t.sc.wc=lh.bind(null,t.eventManager),t}(e);let s,i;const r=n.ic.get(t);if(r)s=r.targetId,n.sharedClientState.addLocalQueryTarget(s),i=r.view.ec();else{const e=await function(e,t){const n=Qr(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let s;return n.Cs.getTargetData(e,t).next((i=>i?(s=i,Eo.resolve(s)):n.Cs.allocateTargetId(e).next((i=>(s=new Uu(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,s).next((()=>s)))))))})).then((e=>{const s=n.qi.get(e.targetId);return(null===s||e.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.qi=n.qi.insert(e.targetId,e),n.Ui.set(t,e.targetId)),e}))}(n.localStore,Ka(t));n.isPrimaryClient&&Nl(n.remoteStore,e);const r=n.sharedClientState.addLocalQueryTarget(e.targetId);s=e.targetId,i=await async function(e,t,n,s,i){e._c=(t,n,s)=>async function(e,t,n,s){let i=t.view.Wu(n);i.$i&&(i=await dl(e.localStore,t.query,!1).then((({documents:e})=>t.view.Wu(e,i))));const r=s&&s.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,r);return Dh(e,t.targetId,o.Xu),o.snapshot}(e,t,n,s);const r=await dl(e.localStore,t,!0),o=new gh(t,r.Hi),a=o.Wu(r.documents),c=Yc.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);Dh(e,n,u.Xu);const l=new mh(t,n,o);return e.ic.set(t,l),e.rc.has(n)?e.rc.get(n).push(t):e.rc.set(n,[t]),u.snapshot}(n,t,s,"current"===r,e.resumeToken)}return i}async function _h(e,t){const n=Qr(e),s=n.ic.get(t),i=n.rc.get(s.targetId);if(i.length>1)return n.rc.set(s.targetId,i.filter((e=>!Qa(e,t)))),void n.ic.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await hl(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),Ol(n.remoteStore,s.targetId),Ah(n,s.targetId)})).catch(Io)):(Ah(n,s.targetId),await hl(n.localStore,s.targetId,!0))}async function bh(e,t){const n=Qr(e);try{const e=await function(e,t){const n=Qr(e),s=t.snapshotVersion;let i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const r=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;const o=[];t.targetChanges.forEach(((r,a)=>{const c=i.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(e,r.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(e,r.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(xo.EMPTY_BYTE_STRING,fo.min()).withLastLimboFreeSnapshotVersion(fo.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,s)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,r)&&o.push(n.Cs.updateTargetData(e,u))}));let a=Vc(),c=Wc();if(t.documentUpdates.forEach((s=>{t.resolvedLimboDocuments.has(s)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,s))})),o.push(function(e,t,n){let s=Wc(),i=Wc();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=Vc();return n.forEach(((n,r)=>{const o=e.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),r.isNoDocument()&&r.version.isEqual(fo.min())?(t.removeEntry(n,r.readTime),s=s.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(r),s=s.insert(n,r)):$r("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{Wi:s,zi:i}}))}(e,r,t.documentUpdates).next((e=>{a=e.Wi,c=e.zi}))),!s.isEqual(fo.min())){const t=n.Cs.getLastRemoteSnapshotVersion(e).next((t=>n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,s)));o.push(t)}return Eo.waitFor(o).next((()=>r.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.qi=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const s=n.cc.get(t);s&&(Wr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?s.nc=!0:e.modifiedDocuments.size>0?Wr(s.nc):e.removedDocuments.size>0&&(Wr(s.nc),s.nc=!1))})),await Lh(n,e,t)}catch(e){await Io(e)}}function Th(e,t,n){const s=Qr(e);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const e=[];s.ic.forEach(((n,s)=>{const i=s.view.bu(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Qr(e);n.onlineState=t;let s=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.bu(t)&&(s=!0)})),s&&hh(n)}(s.eventManager,t),e.length&&s.sc.Wo(e),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function Ih(e,t,n){const s=Qr(e);s.sharedClientState.updateQueryState(t,"rejected",n);const i=s.cc.get(t),r=i&&i.key;if(r){let e=new ka(vo.comparator);e=e.insert(r,La.newNoDocument(r,fo.min()));const n=Wc().add(r),i=new Jc(fo.min(),new Map,new Aa(uo),e,n);await bh(s,i),s.uc=s.uc.remove(r),s.cc.delete(t),Oh(s)}else await hl(s.localStore,t,!1).then((()=>Ah(s,t,n))).catch(Io)}async function Eh(e,t){const n=Qr(e),s=t.batch.batchId;try{const e=await function(e,t){const n=Qr(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const s=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,s){const i=n.batch,r=i.keys();let o=Eo.resolve();return r.forEach((e=>{o=o.next((()=>s.getEntry(t,e))).next((t=>{const r=n.docVersions.get(e);Wr(null!==r),t.version.compareTo(r)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),s.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,s,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Wc();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,s)))}))}(n.localStore,t);Ch(n,s,null),Sh(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Lh(n,e)}catch(e){await Io(e)}}async function kh(e,t,n){const s=Qr(e);try{const e=await function(e,t){const n=Qr(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let s;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Wr(null!==t),s=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,s,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,s))).next((()=>n.localDocuments.getDocuments(e,s)))}))}(s.localStore,t);Ch(s,t,n),Sh(s,t),s.sharedClientState.updateMutationState(t,"rejected",n),await Lh(s,e)}catch(n){await Io(n)}}function Sh(e,t){(e.lc.get(t)||[]).forEach((e=>{e.resolve()})),e.lc.delete(t)}function Ch(e,t,n){const s=Qr(e);let i=s.hc[s.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),s.hc[s.currentUser.toKey()]=i}}function Ah(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const s of e.rc.get(t))e.ic.delete(s),n&&e.sc.wc(s,n);e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((t=>{e.ac.containsKey(t)||Rh(e,t)}))}function Rh(e,t){e.oc.delete(t.path.canonicalString());const n=e.uc.get(t);null!==n&&(Ol(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),Oh(e))}function Dh(e,t,n){for(const s of n)s instanceof fh?(e.ac.addReference(s.key,t),Nh(e,s)):s instanceof ph?($r("SyncEngine","Document no longer in limbo: "+s.key),e.ac.removeReference(s.key,t),e.ac.containsKey(s.key)||Rh(e,s.key)):Gr()}function Nh(e,t){const n=t.key,s=n.path.canonicalString();e.uc.get(n)||e.oc.has(s)||($r("SyncEngine","New document in limbo: "+n),e.oc.add(s),Oh(e))}function Oh(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){const t=e.oc.values().next().value;e.oc.delete(t);const n=new vo(go.fromString(t)),s=e.fc.next();e.cc.set(s,new yh(n)),e.uc=e.uc.insert(n,s),Nl(e.remoteStore,new Uu(Ka(qa(n.path)),s,2,So.at))}}async function Lh(e,t,n){const s=Qr(e),i=[],r=[],o=[];s.ic.isEmpty()||(s.ic.forEach(((e,a)=>{o.push(s._c(a,t,n).then((e=>{if((e||n)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=rl.Ci(a.targetId,e);r.push(t)}})))})),await Promise.all(o),s.sc.Wo(i),await async function(e,t){const n=Qr(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Eo.forEach(t,(t=>Eo.forEach(t.Si,(s=>n.persistence.referenceDelegate.addReference(e,t.targetId,s))).next((()=>Eo.forEach(t.Di,(s=>n.persistence.referenceDelegate.removeReference(e,t.targetId,s)))))))))}catch(e){if(!ko(e))throw e;$r("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.qi.get(t),s=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(s);n.qi=n.qi.insert(t,i)}}}(s.localStore,r))}async function xh(e,t){const n=Qr(e);if(!n.currentUser.isEqual(t)){$r("SyncEngine","User change. New user:",t.toKey());const e=await cl(n.localStore,t);n.currentUser=t,function(e,t){e.lc.forEach((e=>{e.forEach((e=>{e.reject(new Jr(Xr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.lc.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Lh(n,e.ji)}}function Ph(e,t){const n=Qr(e),s=n.cc.get(t);if(s&&s.nc)return Wc().add(s.key);{let e=Wc();const s=n.rc.get(t);if(!s)return e;for(const t of s){const s=n.ic.get(t);e=e.unionWith(s.view.ju)}return e}}function Mh(e){const t=Qr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Eh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=kh.bind(null,t),t}class Uh{constructor(){this.synchronizeTabs=!1}async initialize(e){this.yt=bl(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return function(e,t,n,s){return new al(e,t,n,s)}(this.persistence,new ol,e.initialUser,this.yt)}yc(e){return new nl(il.Bs,this.yt)}gc(e){return new pl}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Fh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Th(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=xh.bind(null,this.syncEngine),await async function(e,t){const n=Qr(e);t?(n._u.delete(2),await Rl(n)):t||(n._u.add(2),await Dl(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ch}createDatastore(e){const t=bl(e.databaseInfo.databaseId),n=(s=e.databaseInfo,new wl(s));var s;return function(e,t,n,s){return new Sl(e,t,n,s)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,s=e.asyncQueue,i=e=>Th(this.syncEngine,e,0),r=ml.C()?new ml:new gl,new Al(t,n,s,i,r);var t,n,s,i,r}createSyncEngine(e,t){return function(e,t,n,s,i,r,o){const a=new vh(e,t,n,s,i,r);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Qr(e);$r("RemoteStore","RemoteStore shutting down."),t._u.add(5),await Dl(t),t.mu.shutdown(),t.gu.set("Unknown")}(this.remoteStore)}}function Vh(e,t,n){if(!n)throw new Jr(Xr.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function qh(e){if(!vo.isDocumentKey(e))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Bh(e){if(vo.isDocumentKey(e))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function jh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Gr()}function $h(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Jr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jh(e);throw new Jr(Xr.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}const Hh=new Map;class zh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Jr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Jr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,s){if(!0===t&&!0===s)throw new Jr(Xr.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kh{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zh({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zh(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new eo;switch(e.type){case"gapi":const t=e.client;return new io(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Jr(Xr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hh.get(e);t&&($r("ComponentProvider","Removing Datastore"),Hh.delete(e),t.terminate())}(this),Promise.resolve()}}class Gh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gh(this.firestore,e,this._key)}}class Wh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Wh(this.firestore,e,this._query)}}class Qh extends Wh{constructor(e,t,n){super(e,t,qa(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gh(this.firestore,null,new vo(e))}withConverter(e){return new Qh(this.firestore,e,this._path)}}function Xh(e,t,...n){if(e=S(e),Vh("collection","path",t),e instanceof Kh){const s=go.fromString(t,...n);return Bh(s),new Qh(e,null,s)}{if(!(e instanceof Gh||e instanceof Qh))throw new Jr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=e._path.child(go.fromString(t,...n));return Bh(s),new Qh(e.firestore,null,s)}}function Jh(e,t,...n){if(e=S(e),1===arguments.length&&(t=co.R()),Vh("doc","path",t),e instanceof Kh){const s=go.fromString(t,...n);return qh(s),new Gh(e,null,new vo(s))}{if(!(e instanceof Gh||e instanceof Qh))throw new Jr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=e._path.child(go.fromString(t,...n));return qh(s),new Gh(e.firestore,e instanceof Qh?e.converter:null,new vo(s))}}class Yh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Hr("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Zh{constructor(e,t,n,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=Vr.UNAUTHENTICATED,this.clientId=co.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{$r("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>($r("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=sh(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ed(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){return e.offlineComponents||($r("FirestoreClient","Using default OfflineComponentProvider"),await async function(e,t){e.asyncQueue.verifyOperationInProgress(),$r("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let s=n.initialUser;e.setCredentialChangeListener((async e=>{s.isEqual(e)||(await cl(t.localStore,e),s=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}(e,new Uh)),e.offlineComponents}(e);$r("FirestoreClient","Initializing OnlineComponentProvider");const s=await e.getConfiguration();await t.initialize(n,s),e.setCredentialChangeListener((e=>Zl(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Zl(t.remoteStore,n))),e.onlineComponents=t}async function td(e){return e.onlineComponents||($r("FirestoreClient","Using default OnlineComponentProvider"),await ed(e,new Fh)),e.onlineComponents}async function nd(e){const t=await td(e),n=t.eventManager;return n.onListen=wh.bind(null,t.syncEngine),n.onUnlisten=_h.bind(null,t.syncEngine),n}class sd{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Tl(this,"async_queue_retry"),this.Wc=()=>{const e=_l();e&&$r("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const e=_l();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const t=_l();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise((()=>{}));const t=new Yr;return this.Hc((()=>this.qc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Lc.push(e),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(e){if(!ko(e))throw e;$r("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(e){const t=this.Bc.then((()=>(this.Gc=!0,e().catch((e=>{this.Kc=e,this.Gc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Hr("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Gc=!1,e))))));return this.Bc=t,t}enqueueAfterDelay(e,t,n){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const s=nh.createAndSchedule(this,e,t,n,(e=>this.Yc(e)));return this.Uc.push(s),s}zc(){this.Kc&&Gr()}verifyOperationInProgress(){}async Xc(){let e;do{e=this.Bc,await e}while(e!==this.Bc)}Zc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then((()=>{this.Uc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()}))}ea(e){this.jc.push(e)}Yc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function id(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class rd extends Kh{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new sd,this._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ad(this),this._firestoreClient.terminate()}}function od(e){return e._firestoreClient||ad(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ad(e){var t;const n=e._freezeSettings(),s=function(e,t,n,s){return new Co(e,t,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Zh(e._authCredentials,e._appCheckCredentials,e._queue,s)}class cd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cd(xo.fromBase64String(e))}catch(e){throw new Jr(Xr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new cd(xo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ud{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ld{constructor(e){this._methodName=e}}class hd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Jr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Jr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return uo(this._lat,e._lat)||uo(this._long,e._long)}}const dd=/^__.*__$/;class fd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Cc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Sc(e,this.data,t,this.fieldTransforms)}}class pd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Cc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gr()}}class md{constructor(e,t,n,s,i,r){this.settings=e,this.databaseId=t,this.yt=n,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=r||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new md(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:n,oa:!1});return s.ua(e),s}ca(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:n,oa:!1});return s.na(),s}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return Rd(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(gd(this.sa)&&dd.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class yd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.yt=n||bl(e)}da(e,t,n,s=!1){return new md({sa:e,methodName:t,fa:n,path:yo.emptyPath(),oa:!1,la:s},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function vd(e){const t=e._freezeSettings(),n=bl(e._databaseId);return new yd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function wd(e,t,n,s,i,r={}){const o=e.da(r.merge||r.mergeFields?2:0,t,n,i);kd("Data must be an object, but it was:",o,s);const a=Id(s,o);let c,u;if(r.merge)c=new Da(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const e=[];for(const s of r.mergeFields){const i=Sd(t,s,n);if(!o.contains(i))throw new Jr(Xr.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Dd(e,i)||e.push(i)}c=new Da(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new fd(new Na(a),c,u)}class _d extends ld{_toFieldTransform(e){if(2!==e.sa)throw 1===e.sa?e.ha(`${this._methodName}() can only appear at the top level of your update data`):e.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _d}}class bd extends ld{_toFieldTransform(e){return new mc(e.path,new cc)}isEqual(e){return e instanceof bd}}function Td(e,t){if(Ed(e=S(e)))return kd("Unsupported field value:",t,e),Id(e,t);if(e instanceof ld)return function(e,t){if(!gd(t.sa))throw t.ha(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.ha(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){const n=[];let s=0;for(const i of e){let e=Td(i,t.aa(s));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),s++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=S(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return sc(t.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ho.fromDate(e);return{timestampValue:lu(t.yt,n)}}if(e instanceof ho){const n=new ho(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:lu(t.yt,n)}}if(e instanceof hd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof cd)return{bytesValue:hu(t.yt,e._byteString)};if(e instanceof Gh){const n=t.databaseId,s=e.firestore._databaseId;if(!s.isEqual(n))throw t.ha(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:pu(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha(`Unsupported field value: ${jh(e)}`)}(e,t)}function Id(e,t){const n={};return No(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Do(e,((e,s)=>{const i=Td(s,t.ra(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Ed(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ho||e instanceof hd||e instanceof cd||e instanceof Gh||e instanceof ld)}function kd(e,t,n){if(!Ed(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const s=jh(n);throw"an object"===s?t.ha(e+" a custom object"):t.ha(e+" "+s)}}function Sd(e,t,n){if((t=S(t))instanceof ud)return t._internalPath;if("string"==typeof t)return Ad(e,t);throw Rd("Field path arguments must be of type string or ",e,!1,void 0,n)}const Cd=new RegExp("[~\\*/\\[\\]]");function Ad(e,t,n){if(t.search(Cd)>=0)throw Rd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ud(...t.split("."))._internalPath}catch(s){throw Rd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Rd(e,t,n,s,i){const r=s&&!s.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new Jr(Xr.INVALID_ARGUMENT,a+e+c)}function Dd(e,t){return e.some((e=>e.isEqual(t)))}class Nd{constructor(e,t,n,s,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Gh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Od(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ld("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Od extends Nd{data(){return super.data()}}function Ld(e,t){return"string"==typeof t?Ad(e,t):t instanceof ud?t._internalPath:t._delegate._internalPath}class xd{}class Pd extends xd{}function Md(e,t,...n){let s=[];t instanceof xd&&s.push(t),s=s.concat(n),function(e){const t=e.filter((e=>e instanceof Fd)).length,n=e.filter((e=>e instanceof Ud)).length;if(t>1||t>0&&n>0)throw new Jr(Xr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const t of s)e=t._apply(e);return e}class Ud extends Pd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ud(e,t,n)}_apply(e){const t=this._parse(e);return $d(e._query,t),new Wh(e.firestore,e.converter,Ga(e._query,t))}_parse(e){const t=vd(e.firestore),n=function(e,t,n,s,i,r,o){let a;if(i.isKeyField()){if("array-contains"===r||"array-contains-any"===r)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${r}' queries on documentId().`);if("in"===r||"not-in"===r){jd(o,r);const t=[];for(const n of o)t.push(Bd(s,e,n));a={arrayValue:{values:t}}}else a=Bd(s,e,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||jd(o,r),a=function(e,t,n,s=!1){return Td(n,e.da(s?4:3,t))}(n,"where",o,"in"===r||"not-in"===r);return ca.create(i,r,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Fd extends xd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fd(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:ua.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const s=t.getFlattenedFilters();for(const e of s)$d(n,e),n=Ga(n,e)}(e._query,t),new Wh(e.firestore,e.converter,Ga(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Vd extends Pd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Vd(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new Ia(t,n);return function(e,t){if(null===ja(e)){const n=$a(e);null!==n&&Hd(0,n,t.field)}}(e,s),s}(e._query,this._field,this._direction);return new Wh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Va(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function qd(e,t="asc"){const n=t,s=Ld("orderBy",e);return Vd._create(s,n)}function Bd(e,t,n){if("string"==typeof(n=S(n))){if(""===n)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ha(t)&&-1!==n.indexOf("/"))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=t.path.child(go.fromString(n));if(!vo.isDocumentKey(s))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Xo(e,new vo(s))}if(n instanceof Gh)return Xo(e,n._key);throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jh(n)}.`)}function jd(e,t){if(!Array.isArray(e)||0===e.length)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function $d(e,t){if(t.isInequality()){const n=$a(e),s=t.field;if(null!==n&&!n.isEqual(s))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${s.toString()}'`);const i=ja(e);null!==i&&Hd(0,s,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Jr(Xr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Jr(Xr.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Hd(e,t,n){if(!n.isEqual(t))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class zd{convertValue(e,t="none"){switch($o(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Uo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Gr()}}convertObject(e,t){const n={};return Do(e.fields,((e,s)=>{n[e]=this.convertValue(s,t)})),n}convertGeoPoint(e){return new hd(Uo(e.latitude),Uo(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=qo(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Bo(e));default:return null}}convertTimestamp(e){const t=Mo(e);return new ho(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=go.fromString(e);Wr(Lu(n));const s=new Ao(n.get(1),n.get(3)),i=new vo(n.popFirst(5));return s.isEqual(t)||Hr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class Kd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gd extends Nd{constructor(e,t,n,s,i,r){super(e,t,n,s,r),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ld("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Wd extends Gd{data(e={}){return super.data(e)}}class Qd{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Kd(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Wd(this._firestore,this._userDataWriter,n.key,n,new Kd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Jr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const s=new Wd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Kd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:s,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const s=new Wd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Kd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,r=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),r=n.indexOf(t.doc.key)),{type:Xd(t.type),doc:s,oldIndex:i,newIndex:r}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Xd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gr()}}class Jd extends zd{constructor(e){super(),this.firestore=e}convertBytes(e){return new cd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gh(this.firestore,null,t)}}function Yd(e,t,n,...s){e=$h(e,Gh);const i=$h(e.firestore,rd),r=vd(i);let o;return o="string"==typeof(t=S(t))||t instanceof ud?function(e,t,n,s,i,r){const o=e.da(1,t,n),a=[Sd(t,s,n)],c=[i];if(r.length%2!=0)throw new Jr(Xr.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<r.length;e+=2)a.push(Sd(t,r[e])),c.push(r[e+1]);const u=[],l=Na.empty();for(let e=a.length-1;e>=0;--e)if(!Dd(u,a[e])){const t=a[e];let n=c[e];n=S(n);const s=o.ca(t);if(n instanceof _d)u.push(t);else{const e=Td(n,s);null!=e&&(u.push(t),l.set(t,e))}}const h=new Da(u);return new pd(l,h,o.fieldTransforms)}(r,"updateDoc",e._key,t,n,s):function(e,t,n,s){const i=e.da(1,t,n);kd("Data must be an object, but it was:",i,s);const r=[],o=Na.empty();Do(s,((e,s)=>{const a=Ad(t,e,n);s=S(s);const c=i.ca(a);if(s instanceof _d)r.push(a);else{const e=Td(s,c);null!=e&&(r.push(a),o.set(a,e))}}));const a=new Da(r);return new pd(o,a,i.fieldTransforms)}(r,"updateDoc",e._key,t),tf(i,[o.toMutation(e._key,vc.exists(!0))])}function Zd(e,t){const n=$h(e.firestore,rd),s=Jh(e),i=function(e,t,n){let s;return s=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,s}(e.converter,t);return tf(n,[wd(vd(e.firestore),"addDoc",s._key,i,null!==e.converter,{}).toMutation(s._key,vc.exists(!1))]).then((()=>s))}function ef(e,...t){var n,s,i;e=S(e);let r={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||id(t[o])||(r=t[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges};if(id(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof Gh)u=$h(e.firestore,rd),l=qa(e._key.path),c={next:n=>{t[o]&&t[o](function(e,t,n){const s=n.docs.get(t._key),i=new Jd(e);return new Gd(e,i,t._key,s,new Kd(n.hasPendingWrites,n.fromCache),t.converter)}(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=$h(e,Wh);u=$h(n.firestore,rd),l=n._query;const s=new Jd(u);c={next:e=>{t[o]&&t[o](new Qd(u,s,n,e))},error:t[o+1],complete:t[o+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Jr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,s){const i=new Yh(s),r=new dh(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Qr(e),s=t.query;let i=!1,r=n.queries.get(s);if(r||(i=!0,r=new ah),i)try{r.Au=await n.onListen(s)}catch(e){const n=sh(e,`Initialization of query '${Ja(t.query)}' failed`);return void t.onError(n)}n.queries.set(s,r),r.listeners.push(t),t.bu(n.onlineState),r.Au&&t.Pu(r.Au)&&hh(n)}(await nd(e),r))),()=>{i.bc(),e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Qr(e),s=t.query;let i=!1;const r=n.queries.get(s);if(r){const e=r.listeners.indexOf(t);e>=0&&(r.listeners.splice(e,1),i=0===r.listeners.length)}if(i)return n.queries.delete(s),n.onUnlisten(s)}(await nd(e),r)))}}(od(u),l,a,c)}function tf(e,t){return function(e,t){const n=new Yr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const s=Mh(e);try{const e=await function(e,t){const n=Qr(e),s=ho.now(),i=t.reduce(((e,t)=>e.add(t.key)),Wc());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Vc(),c=Wc();return n.Gi.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{r=i;const o=[];for(const e of t){const t=Ec(e,r.get(e.key).overlayedDocument);null!=t&&o.push(new Cc(e.key,t,Oa(t.value.mapValue),vc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,s,o,t)})).next((t=>{o=t;const s=t.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,s)}))})).then((()=>({batchId:o.batchId,changes:jc(r)})))}(s.localStore,t);s.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let s=e.hc[e.currentUser.toKey()];s||(s=new ka(uo)),s=s.insert(t,n),e.hc[e.currentUser.toKey()]=s}(s,e.batchId,n),await Lh(s,e.changes),await Hl(s.remoteStore)}catch(e){const t=sh(e,"Failed to persist write");n.reject(t)}}(await function(e){return td(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(od(e),t)}function nf(){return new bd("serverTimestamp")}function sf(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}!function(e,t=!0){!function(e){qr=e}(ge),he(new C("firestore",((e,{instanceIdentifier:n,options:s})=>{const i=e.getProvider("app").getImmediate(),r=new rd(new no(e.getProvider("auth-internal")),new oo(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Jr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ao(e.options.projectId,t)}(i,n),i);return s=Object.assign({useFetchStreams:t},s),r._setSettings(s),r}),"PUBLIC").setMultipleInstances(!0)),ve(Fr,"3.8.0",e),ve(Fr,"3.8.0","esm2017")}(),Object.create,Object.create;const rf=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},of=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),af=new F("@firebase/auth");function cf(e,...t){af.logLevel<=O.ERROR&&af.error(`Auth (${ge}): ${e}`,...t)}function uf(e,...t){throw hf(e,...t)}function lf(e,...t){return hf(e,...t)}function hf(e,...t){if("string"!=typeof e){const n=t[0],s=[...t.slice(1)];return s[0]&&(s[0].appName=e.name),e._errorFactory.create(n,...s)}return of.create(e,...t)}function df(e,t,...n){if(!e)throw hf(t,...n)}function ff(e){const t="INTERNAL ASSERTION FAILED: "+e;throw cf(t),new Error(t)}function pf(e,t){e||ff(t)}const gf=new Map;function mf(e){pf(e instanceof Function,"Expected a class definition");let t=gf.get(e);return t?(pf(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,gf.set(e,t),t)}function yf(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function vf(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class wf{constructor(e,t){this.shortDelay=e,this.longDelay=t,pf(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(r())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===vf()||"https:"===vf()||o()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function _f(e,t){pf(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class bf{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ff("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ff("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ff("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Tf={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},If=new wf(3e4,6e4);function Ef(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function kf(e,t,n,s,i={}){return Sf(e,i,(async()=>{let i={},r={};s&&("GET"===t?r=s:i={body:JSON.stringify(s)});const o=_(Object.assign({key:e.config.apiKey},r)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),bf.fetch()(Af(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Sf(e,t,n){e._canInitEmulator=!1;const s=Object.assign(Object.assign({},Tf),t);try{const t=new Rf(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const r=await i.json();if("needConfirmation"in r)throw Df(e,"account-exists-with-different-credential",r);if(i.ok&&!("errorMessage"in r))return r;{const t=i.ok?r.errorMessage:r.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Df(e,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw Df(e,"email-already-in-use",r);if("USER_DISABLED"===n)throw Df(e,"user-disabled",r);const a=s[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const s=Object.assign(Object.assign({},rf()),{[t]:n});return new m("auth","Firebase",s).create(t,{appName:e.name})}(e,a,o);uf(e,a)}}catch(t){if(t instanceof g)throw t;uf(e,"network-request-failed")}}async function Cf(e,t,n,s,i={}){const r=await kf(e,t,n,s,i);return"mfaPendingCredential"in r&&uf(e,"multi-factor-auth-required",{_serverResponse:r}),r}function Af(e,t,n,s){const i=`${t}${n}?${s}`;return e.config.emulator?_f(e.config,i):`${e.config.apiScheme}://${i}`}class Rf{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(lf(this.auth,"network-request-failed"))),If.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Df(e,t,n){const s={appName:e.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=lf(e,t,s);return i.customData._tokenResponse=n,i}function Nf(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Of(e){return 1e3*Number(e)}function Lf(e){const[t,n,s]=e.split(".");if(void 0===t||void 0===n||void 0===s)return cf("JWT malformed, contained fewer than 3 sections"),null;try{const e=i(n);return e?JSON.parse(e):(cf("Failed to decode base64 JWT payload"),null)}catch(e){return cf("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function xf(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Pf{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Mf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nf(this.lastLoginAt),this.creationTime=Nf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Uf(e){var t;const n=e.auth,s=await e.getIdToken(),i=await xf(e,async function(e,t){return kf(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:s}));df(null==i?void 0:i.users.length,n,"internal-error");const r=i.users[0];e._notifyReloadListener(r);const o=(null===(t=r.providerUserInfo)||void 0===t?void 0:t.length)?r.providerUserInfo.map((e=>{var{providerId:t}=e,n=sf(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Mf(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class Ff{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){df(e.idToken,"internal-error"),df(void 0!==e.idToken,"internal-error"),df(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Lf(e);return df(t,"internal-error"),df(void 0!==t.exp,"internal-error"),df(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return df(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:i}=await async function(e,t){const n=await Sf(e,{},(async()=>{const n=_({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=e.config,r=Af(e,s,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",bf.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:i}=t,r=new Ff;return n&&(df("string"==typeof n,"internal-error",{appName:e}),r.refreshToken=n),s&&(df("string"==typeof s,"internal-error",{appName:e}),r.accessToken=s),i&&(df("number"==typeof i,"internal-error",{appName:e}),r.expirationTime=i),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ff,this.toJSON())}_performRefresh(){return ff("not implemented")}}function Vf(e,t){df("string"==typeof e||void 0===e,"internal-error",{appName:t})}class qf{constructor(e){var{uid:t,auth:n,stsTokenManager:s}=e,i=sf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Pf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xf(this,this.stsTokenManager.getToken(this.auth,e));return df(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=S(e),s=await n.getIdToken(t),i=Lf(s);df(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r="object"==typeof i.firebase?i.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Nf(Of(i.auth_time)),issuedAtTime:Nf(Of(i.iat)),expirationTime:Nf(Of(i.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=S(e);await Uf(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(df(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new qf(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){df(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Uf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await xf(this,async function(e,t){return kf(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,s,i,r,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(s=t.email)&&void 0!==s?s:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(r=t.photoURL)&&void 0!==r?r:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:_,providerData:b,stsTokenManager:T}=t;df(v&&T,e,"internal-error");const I=Ff.fromJSON(this.name,T);df("string"==typeof v,e,"internal-error"),Vf(l,e.name),Vf(h,e.name),df("boolean"==typeof w,e,"internal-error"),df("boolean"==typeof _,e,"internal-error"),Vf(d,e.name),Vf(f,e.name),Vf(p,e.name),Vf(g,e.name),Vf(m,e.name),Vf(y,e.name);const E=new qf({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const s=new Ff;s.updateFromServerResponse(t);const i=new qf({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Uf(i),i}}class Bf{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Bf.type="NONE";const jf=Bf;function $f(e,t,n){return`firebase:${e}:${t}:${n}`}class Hf{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=$f(this.userKey,s.apiKey,i),this.fullPersistenceKey=$f("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qf._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Hf(mf(jf),e,n);const s=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=s[0]||mf(jf);const r=$f(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(r);if(t){const s=qf._fromJSON(e,t);n!==i&&(o=s),i=n;break}}catch(e){}const a=s.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(r,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(r)}catch(e){}}))),new Hf(i,e,n)):new Hf(i,e,n)}}function zf(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Qf(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Kf(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Jf(t))return"Blackberry";if(Yf(t))return"Webos";if(Gf(t))return"Safari";if((t.includes("chrome/")||Wf(t))&&!t.includes("edge/"))return"Chrome";if(Xf(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Kf(e=r()){return/firefox\//i.test(e)}function Gf(e=r()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Wf(e=r()){return/crios\//i.test(e)}function Qf(e=r()){return/iemobile/i.test(e)}function Xf(e=r()){return/android/i.test(e)}function Jf(e=r()){return/blackberry/i.test(e)}function Yf(e=r()){return/webos/i.test(e)}function Zf(e=r()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ep(e=r()){return Zf(e)||Xf(e)||Yf(e)||Jf(e)||/windows phone/i.test(e)||Qf(e)}function tp(e,t=[]){let n;switch(e){case"Browser":n=zf(r());break;case"Worker":n=`${zf(r())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${ge}/${s}`}class np{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,s)=>{try{n(e(t))}catch(e){s(e)}}));n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class sp{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rp(this),this.idTokenSubscription=new rp(this),this.beforeStateQueue=new np(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=of,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mf(t)),this._initializationPromise=this.queue((async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Hf.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==s?void 0:s._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==r||!(null==o?void 0:o.user)||(s=o.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(e){s=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return df(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Uf(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?S(e):null;return t&&df(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&df(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(mf(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new m("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&mf(e)||this._popupRedirectResolver;df(t,this,"argument-error"),this.redirectPersistenceManager=await Hf.create(this,[mf(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),r=this._isInitialized?Promise.resolve():this._initializationPromise;return df(r,this,"internal-error"),r.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,s):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return df(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());return n&&(t["X-Firebase-Client"]=n),t}}function ip(e){return S(e)}class rp{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new I(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return df(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function op(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ap(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class cp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ff("not implemented")}_getIdTokenResponse(e){return ff("not implemented")}_linkToIdToken(e,t){return ff("not implemented")}_getReauthenticationResolver(e){return ff("not implemented")}}class up extends cp{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new up(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new up(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return Cf(e,"POST","/v1/accounts:signInWithPassword",Ef(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Cf(e,"POST","/v1/accounts:signInWithEmailLink",Ef(e,t))}(e,{email:this._email,oobCode:this._password});default:uf(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return kf(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Cf(e,"POST","/v1/accounts:signInWithEmailLink",Ef(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:uf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function lp(e,t){return Cf(e,"POST","/v1/accounts:signInWithIdp",Ef(e,t))}class hp extends cp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):uf("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:s}=t,i=sf(t,["providerId","signInMethod"]);if(!n||!s)return null;const r=new hp(n,s);return r.idToken=i.idToken||void 0,r.accessToken=i.accessToken||void 0,r.secret=i.secret,r.nonce=i.nonce,r.pendingToken=i.pendingToken||null,r}_getIdTokenResponse(e){return lp(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,lp(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,lp(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_(t)}return e}}const dp={USER_NOT_FOUND:"user-not-found"};class fp extends cp{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new fp({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new fp({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Cf(e,"POST","/v1/accounts:signInWithPhoneNumber",Ef(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Cf(e,"POST","/v1/accounts:signInWithPhoneNumber",Ef(e,t));if(n.temporaryProof)throw Df(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Cf(e,"POST","/v1/accounts:signInWithPhoneNumber",Ef(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),dp)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:i}=e;return n||t||s||i?new fp({verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:i}):null}}class pp{constructor(e){var t,n,s,i,r,o;const a=b(T(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=a.mode)&&void 0!==s?s:null);df(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=b(T(e)).link,n=t?b(T(t)).deep_link_id:null,s=b(T(e)).deep_link_id;return(s?b(T(s)).link:null)||s||n||t||e}(e);try{return new pp(t)}catch(e){return null}}}class gp{constructor(){this.providerId=gp.PROVIDER_ID}static credential(e,t){return up._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=pp.parseLink(t);return df(n,"argument-error"),up._fromEmailAndCode(e,n.code,n.tenantId)}}gp.PROVIDER_ID="password",gp.EMAIL_PASSWORD_SIGN_IN_METHOD="password",gp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class yp extends mp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class vp extends yp{constructor(){super("facebook.com")}static credential(e){return hp._fromParams({providerId:vp.PROVIDER_ID,signInMethod:vp.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vp.credentialFromTaggedObject(e)}static credentialFromError(e){return vp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return vp.credential(e.oauthAccessToken)}catch(e){return null}}}vp.FACEBOOK_SIGN_IN_METHOD="facebook.com",vp.PROVIDER_ID="facebook.com";class wp extends yp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hp._fromParams({providerId:wp.PROVIDER_ID,signInMethod:wp.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wp.credentialFromTaggedObject(e)}static credentialFromError(e){return wp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return wp.credential(t,n)}catch(e){return null}}}wp.GOOGLE_SIGN_IN_METHOD="google.com",wp.PROVIDER_ID="google.com";class _p extends yp{constructor(){super("github.com")}static credential(e){return hp._fromParams({providerId:_p.PROVIDER_ID,signInMethod:_p.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _p.credentialFromTaggedObject(e)}static credentialFromError(e){return _p.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return _p.credential(e.oauthAccessToken)}catch(e){return null}}}_p.GITHUB_SIGN_IN_METHOD="github.com",_p.PROVIDER_ID="github.com";class bp extends yp{constructor(){super("twitter.com")}static credential(e,t){return hp._fromParams({providerId:bp.PROVIDER_ID,signInMethod:bp.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return bp.credentialFromTaggedObject(e)}static credentialFromError(e){return bp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return bp.credential(t,n)}catch(e){return null}}}bp.TWITTER_SIGN_IN_METHOD="twitter.com",bp.PROVIDER_ID="twitter.com";class Tp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const i=await qf._fromIdTokenResponse(e,n,s),r=Ip(n);return new Tp({user:i,providerId:r,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=Ip(n);return new Tp({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function Ip(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ep extends g{constructor(e,t,n,s){var i;super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ep.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Ep(e,t,n,s)}}function kp(e,t,n,s){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ep._fromErrorAndOperation(e,n,t,s);throw n}))}new WeakMap;const Sp="__sak";class Cp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Sp,"1"),this.storage.removeItem(Sp),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ap extends Cp{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=r();return Gf(e)||Zf(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=ep(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const s=this.storage.getItem(n);if(e.newValue!==s)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const s=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=r();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?s():setTimeout(s,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ap.type="LOCAL";const Rp=Ap;class Dp extends Cp{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Dp.type="SESSION";const Np=Dp;class Op{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Op(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:i}=t.data,r=this.handlersMap[s];if(!(null==r?void 0:r.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(r).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Lp(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Op.receivers=[];class xp{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,r;return new Promise(((o,a)=>{const c=Lp("",20);s.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:s,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(r),s.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function Pp(){return window}function Mp(){return void 0!==Pp().WorkerGlobalScope&&"function"==typeof Pp().importScripts}const Up="firebaseLocalStorageDb",Fp="firebaseLocalStorage",Vp="fbase_key";class qp{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Bp(e,t){return e.transaction([Fp],t?"readwrite":"readonly").objectStore(Fp)}function jp(){const e=indexedDB.open(Up,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Fp,{keyPath:Vp})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Fp)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Up);return new qp(e).toPromise()}(),t(await jp()))}))}))}async function $p(e,t,n){const s=Bp(e,!0).put({[Vp]:t,value:n});return new qp(s).toPromise()}function Hp(e,t){const n=Bp(e,!0).delete(t);return new qp(n).toPromise()}class zp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await jp()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Mp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Op._getInstance(Mp()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new xp(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jp();return await $p(e,Sp,"1"),await Hp(e,Sp),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>$p(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Bp(e,!1).get(t),s=await new qp(n).toPromise();return void 0===s?null:s.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Hp(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Bp(e,!1).getAll();return new qp(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}zp.type="LOCAL";const Kp=zp;function Gp(e){return`__${e}${Math.floor(1e6*Math.random())}`}Gp("rcb"),new wf(3e4,6e4);class Wp{constructor(e){this.providerId=Wp.PROVIDER_ID,this.auth=ip(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var s;const i=await n.verify();try{let r;if(df("string"==typeof i,e,"argument-error"),df("recaptcha"===n.type,e,"argument-error"),r="string"==typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){df("enroll"===t.type,e,"internal-error");const n=await function(e,t){return kf(e,"POST","/v2/accounts/mfaEnrollment:start",Ef(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{df("signin"===t.type,e,"internal-error");const n=(null===(s=r.multiFactorHint)||void 0===s?void 0:s.uid)||r.multiFactorUid;df(n,e,"missing-multi-factor-info");const o=await function(e,t){return kf(e,"POST","/v2/accounts/mfaSignIn:start",Ef(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return kf(e,"POST","/v1/accounts:sendVerificationCode",Ef(e,t))}(e,{phoneNumber:r.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}(this.auth,e,S(t))}static credential(e,t){return fp._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Wp.credentialFromTaggedObject(t)}static credentialFromError(e){return Wp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?fp._fromTokenResponse(t,n):null}}Wp.PROVIDER_ID="phone",Wp.PHONE_SIGN_IN_METHOD="phone";class Qp extends cp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return lp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return lp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Xp(e){return async function(e,t,n=!1){const s="signIn",i=await kp(e,s,t),r=await Tp._fromIdTokenResponse(e,s,i);return n||await e._updateCurrentUser(r.user),r}(e.auth,new Qp(e),e.bypassAuthState)}function Jp(e){const{auth:t,user:n}=e;return df(n,t,"internal-error"),async function(e,t,n=!1){const{auth:s}=e,i="reauthenticate";try{const r=await xf(e,kp(s,i,t,e),n);df(r.idToken,s,"internal-error");const o=Lf(r.idToken);df(o,s,"internal-error");const{sub:a}=o;return df(e.uid===a,s,"user-mismatch"),Tp._forOperation(e,i,r)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&uf(s,"user-mismatch"),e}}(n,new Qp(e),e.bypassAuthState)}async function Yp(e){const{auth:t,user:n}=e;return df(n,t,"internal-error"),async function(e,t,n=!1){const s=await xf(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Tp._forOperation(e,"link",s)}(n,new Qp(e),e.bypassAuthState)}class Zp{constructor(e,t,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:i,error:r,type:o}=e;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xp;case"linkViaPopup":case"linkViaRedirect":return Yp;case"reauthViaPopup":case"reauthViaRedirect":return Jp;default:uf(this.auth,"internal-error")}}resolve(e){pf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const eg=new wf(2e3,1e4);class tg extends Zp{constructor(e,t,n,s,i){super(e,t,s,i),this.provider=n,this.authWindow=null,this.pollId=null,tg.currentPopupAction&&tg.currentPopupAction.cancel(),tg.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return df(e,this.auth,"internal-error"),e}async onExecution(){pf(1===this.filter.length,"Popup operations only handle one event");const e=Lp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(lf(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(lf(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tg.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(lf(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,eg.get())};e()}}tg.currentPopupAction=null;const ng=new Map;class sg extends Zp{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ng.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return $f("pendingRedirect",e.config.apiKey,e.name)}(t),s=function(e){return mf(e._redirectPersistence)}(e);if(!await s._isAvailable())return!1;const i="true"===await s._get(n);return await s._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ng.set(this.auth._key(),e)}return this.bypassAuthState||ng.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ig(e,t){ng.set(e._key(),t)}async function rg(e,t,n=!1){const s=ip(e),i=function(e,t){return t?mf(t):(df(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(s,t),r=new sg(s,i,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,t)),o}class og{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cg(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!cg(e)){const s=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(lf(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ag(e))}saveEventToCache(e){this.cachedEventUids.add(ag(e)),this.lastProcessedEventTime=Date.now()}}function ag(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function cg({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const ug=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lg=/^https?/;function hg(e){const t=yf(),{protocol:n,hostname:s}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===s?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===s}if(!lg.test(n))return!1;if(ug.test(e))return s===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}const dg=new wf(3e4,6e4);function fg(){const e=Pp().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let pg=null;function gg(e){return pg=pg||function(e){return new Promise(((t,n)=>{var s,i,r,o;function a(){fg(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{fg(),n(lf(e,"network-request-failed"))},timeout:dg.get()})}if(null===(i=null===(s=Pp().gapi)||void 0===s?void 0:s.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(r=Pp().gapi)||void 0===r?void 0:r.load)){const t=Gp("iframefcb");return Pp()[t]=()=>{gapi.load?a():n(lf(e,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=lf("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(n)}))).catch((e=>n(e)))}a()}})).catch((e=>{throw pg=null,e}))}(e),pg}const mg=new wf(5e3,15e3),yg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wg(e){const t=e.config;df(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?_f(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:ge},i=vg.get(e.config.apiHost);i&&(s.eid=i);const r=e._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${_(s).slice(1)}`}const _g={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class bg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Tg(e,t,n,s,i,r){df(e.config.authDomain,e,"auth-domain-config-required"),df(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:ge,eventId:i};if(t instanceof mp){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(r||{}))o[e]=t}if(t instanceof yp){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?_f(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${_(a).slice(1)}`}const Ig="webStorageSupport",Eg=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Np,this._completeRedirectFn=rg,this._overrideRedirectResult=ig}async _openPopup(e,t,n,s){var i;return pf(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,s=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let c="";const u=Object.assign(Object.assign({},_g),{width:s.toString(),height:i.toString(),top:o,left:a}),l=r().toLowerCase();n&&(c=Wf(l)?"_blank":n),Kf(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=r()){var t;return Zf(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}(t||"",c),new bg(null);const d=window.open(t||"",c,h);df(d,e,"popup-blocked");try{d.focus()}catch(e){}return new bg(d)}(e,Tg(e,t,n,yf(),s),Lp())}async _openRedirect(e,t,n,s){var i;return await this._originValidation(e),i=Tg(e,t,n,yf(),s),Pp().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(pf(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await gg(e),n=Pp().gapi;return df(n,e,"internal-error"),t.open({where:document.body,url:wg(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yg,dontclear:!0},(t=>new Promise((async(n,s)=>{await t.restyle({setHideOnLeave:!1});const i=lf(e,"network-request-failed"),r=Pp().setTimeout((()=>{s(i)}),mg.get());function o(){Pp().clearTimeout(r),n(t)}t.ping(o).then(o,(()=>{s(i)}))}))))}(e),n=new og(e);return t.register("authEvent",(t=>(df(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ig,{type:Ig},(n=>{var s;const i=null===(s=null==n?void 0:n[0])||void 0===s?void 0:s[Ig];void 0!==i&&t(!!i),uf(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return kf(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(hg(e))return}catch(e){}uf(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ep()||Gf()||Zf()}};var kg="@firebase/auth",Sg="0.21.0";class Cg{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){df(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ag=d("authIdTokenMaxAge")||300;let Rg=null;var Dg;Dg="Browser",he(new C("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:r}=n.options;return((e,n)=>{df(i&&!i.includes(":"),"invalid-api-key",{appName:e.name}),df(!(null==r?void 0:r.includes(":")),"argument-error",{appName:e.name});const s={apiKey:i,authDomain:r,clientPlatform:Dg,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tp(Dg)},o=new sp(e,n,s);return function(e,t){const n=(null==t?void 0:t.persistence)||[],s=(Array.isArray(n)?n:[n]).map(mf);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(s,null==t?void 0:t.popupRedirectResolver)}(o,t),o})(n,s)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),he(new C("auth-internal",(e=>{return t=ip(e.getProvider("auth").getImmediate()),new Cg(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),ve(kg,Sg,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Dg)),ve(kg,Sg,"esm2017");const Ng="firebasestorage.googleapis.com",Og="storageBucket";class Lg extends g{constructor(e,t,n=0){super(xg(e),`Firebase Storage: ${t} (${xg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Lg.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return xg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function xg(e){return"storage/"+e}function Pg(){return new Lg("unknown","An unknown error occurred, please check the error payload for server response.")}function Mg(){return new Lg("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function Ug(){return new Lg("canceled","User canceled the upload/download.")}function Fg(){return new Lg("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Vg(e){return new Lg("invalid-argument",e)}function qg(){return new Lg("app-deleted","The Firebase app was deleted.")}function Bg(e,t){return new Lg("invalid-format","String does not match format '"+e+"': "+t)}function jg(e){throw new Lg("internal-error","Internal error: "+e)}class $g{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=$g.makeFromUrl(e,t)}catch(t){return new $g(e,"")}if(""===n.path)return n;throw new Lg("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const s="([A-Za-z0-9.\\-_]+)",i=new RegExp("^gs://"+s+"(/(.*))?$","i");function r(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${s}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:r},{regex:new RegExp(`^https?://${t===Ng?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${s}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:r}];for(let t=0;t<a.length;t++){const s=a[t],i=s.regex.exec(e);if(i){const e=i[s.indices.bucket];let t=i[s.indices.path];t||(t=""),n=new $g(e,t),s.postModify(n);break}}if(null==n)throw function(e){return new Lg("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class Hg{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function zg(e){return"string"==typeof e||e instanceof String}function Kg(e){return Gg()&&e instanceof Blob}function Gg(){return"undefined"!=typeof Blob&&!function(){try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}()}function Wg(e,t,n,s){if(s<t)throw Vg(`Invalid value for '${e}'. Expected ${t} or greater.`);if(s>n)throw Vg(`Invalid value for '${e}'. Expected ${n} or less.`)}function Qg(e,t,n){let s=t;return null==n&&(s=`https://${t}`),`${n}://${s}/v0${e}`}function Xg(e){const t=encodeURIComponent;let n="?";for(const s in e)e.hasOwnProperty(s)&&(n=n+(t(s)+"=")+t(e[s])+"&");return n=n.slice(0,-1),n}var Jg;function Yg(e,t){const n=e>=500&&e<600,s=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||s||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Jg||(Jg={}));class Zg{constructor(e,t,n,s,i,r,o,a,c,u,l,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=r,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{const n=this.resolve_,s=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(e){s(e)}else if(null!==i){const e=Pg();e.serverResponse=i.getErrorText(),this.errorCallback_?s(this.errorCallback_(i,e)):s(e)}else t.canceled?s(this.appDelete_?qg():Ug()):s(Mg())};this.canceled_?e(0,new em(!1,null,!0)):this.backoffId_=function(e,t,n){let s=1,i=null,r=null,o=!1,a=0;function c(){return 2===a}let u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){i=setTimeout((()=>{i=null,e(f,c())}),t)}function d(){r&&clearTimeout(r)}function f(e,...t){if(u)return void d();if(e)return d(),void l.call(null,e,...t);if(c()||o)return d(),void l.call(null,e,...t);let n;s<64&&(s*=2),1===a?(a=2,n=0):n=1e3*(s+Math.random()),h(n)}let p=!1;function g(e){p||(p=!0,d(),u||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),r=setTimeout((()=>{o=!0,g(!0)}),n),g}(((e,t)=>{if(t)return void e(!1,new em(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const s=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(s),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(s),this.pendingConnection_=null;const t=n.getErrorCode()===Jg.NO_ERROR,i=n.getStatus();if((!t||Yg(i,this.additionalRetryCodes_))&&this.retry){const t=n.getErrorCode()===Jg.ABORT;return void e(!1,new em(!1,null,t))}const r=-1!==this.successCodes_.indexOf(i);e(!0,new em(r,n))}))}),e,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class em{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function tm(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function nm(...e){const t=tm();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(Gg())return new Blob(e);throw new Lg("unsupported-environment","This browser doesn't seem to support creating Blobs")}const sm="base64",im="base64url",rm="data_url";class om{constructor(e,t){this.data=e,this.contentType=t||null}}function am(e){const t=[];for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<=127?t.push(s):s<=2047?t.push(192|s>>6,128|63&s):55296==(64512&s)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(s=65536|(1023&s)<<10|1023&e.charCodeAt(++n),t.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s)):t.push(239,191,189):56320==(64512&s)?t.push(239,191,189):t.push(224|s>>12,128|s>>6&63,128|63&s)}return new Uint8Array(t)}function cm(e,t){switch(e){case sm:{const n=-1!==t.indexOf("-"),s=-1!==t.indexOf("_");if(n||s)throw Bg(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case im:{const n=-1!==t.indexOf("+"),s=-1!==t.indexOf("/");if(n||s)throw Bg(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function(e){if("undefined"==typeof atob)throw new Lg("unsupported-environment","base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw Bg(e,"Invalid character found")}const s=new Uint8Array(n.length);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return s}class um{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Bg(rm,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;var s,i;null!=n&&(this.base64=(i=";base64",(s=n).length>=i.length&&s.substring(s.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class lm{constructor(e,t){let n=0,s="";Kg(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(Kg(this.data_)){const r=(n=this.data_,s=e,i=t,n.webkitSlice?n.webkitSlice(s,i):n.mozSlice?n.mozSlice(s,i):n.slice?n.slice(s,i):null);return null===r?null:new lm(r)}var n,s,i;{const n=new Uint8Array(this.data_.buffer,e,t-e);return new lm(n,!0)}}static getBlob(...e){if(Gg()){const t=e.map((e=>e instanceof lm?e.data_:e));return new lm(nm.apply(null,t))}{const t=e.map((e=>zg(e)?function(e,t){switch(e){case"raw":return new om(am(t));case sm:case im:return new om(cm(e,t));case rm:return new om(function(e){const t=new um(e);return t.base64?cm(sm,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw Bg(rm,"Malformed data URL.")}return am(t)}(t.rest)}(t),new um(t).contentType)}throw Pg()}("raw",e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const s=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)s[i++]=e[t]})),new lm(s,!0)}}uploadData(){return this.data_}}function hm(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}function dm(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function fm(e,t){return t}class pm{constructor(e,t,n,s){this.server=e,this.local=t||e,this.writable=!!n,this.xform=s||fm}}let gm=null;function mm(){if(gm)return gm;const e=[];e.push(new pm("bucket")),e.push(new pm("generation")),e.push(new pm("metageneration")),e.push(new pm("name","fullPath",!0));const t=new pm("name");t.xform=function(e,t){return function(e){return!zg(e)||e.length<2?e:dm(e)}(t)},e.push(t);const n=new pm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new pm("timeCreated")),e.push(new pm("updated")),e.push(new pm("md5Hash",null,!0)),e.push(new pm("cacheControl",null,!0)),e.push(new pm("contentDisposition",null,!0)),e.push(new pm("contentEncoding",null,!0)),e.push(new pm("contentLanguage",null,!0)),e.push(new pm("contentType",null,!0)),e.push(new pm("metadata","customMetadata",!0)),gm=e,gm}function ym(e,t,n){const s=hm(t);return null===s?null:function(e,t,n){const s={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];s[i.local]=i.xform(s,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,s=e.fullPath,i=new $g(n,s);return t._makeStorageReference(i)}})}(s,e),s}(e,s,n)}function vm(e,t){const n={},s=t.length;for(let i=0;i<s;i++){const s=t[i];s.writable&&(n[s.server]=e[s.local])}return JSON.stringify(n)}class wm{constructor(e,t,n,s){this.url=e,this.method=t,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function _m(e){if(!e)throw Pg()}function bm(e,t){return function(n,s){const i=ym(e,s,t);return _m(null!==i),i}}function Tm(e){return function(t,n){let s;var i,r;return 401===t.getStatus()?s=t.getErrorText().includes("Firebase App Check token is invalid")?new Lg("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Lg("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(r=e.bucket,s=new Lg("quota-exceeded","Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,s=new Lg("unauthorized","User does not have permission to access '"+i+"'.")):s=n,s.status=t.getStatus(),s.serverResponse=n.serverResponse,s}}function Im(e){const t=Tm(e);return function(n,s){let i=t(n,s);var r;return 404===n.getStatus()&&(r=e.path,i=new Lg("object-not-found","Object '"+r+"' does not exist.")),i.serverResponse=s.serverResponse,i}}function Em(e,t,n){const s=Object.assign({},n);return s.fullPath=e.path,s.size=t.size(),s.contentType||(s.contentType=function(e,t){return t&&t.type()||"application/octet-stream"}(0,t)),s}class km{constructor(e,t,n,s){this.current=e,this.total=t,this.finalized=!!n,this.metadata=s||null}}function Sm(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){_m(!1)}return _m(!!n&&-1!==(t||["active"]).indexOf(n)),n}const Cm=262144;const Am="running",Rm="paused",Dm="success",Nm="canceled",Om="error";function Lm(e){switch(e){case"running":case"pausing":case"canceling":return Am;case"paused":return Rm;case"success":return Dm;case"canceled":return Nm;default:return Om}}class xm{constructor(e,t,n){const s=function(e){return"function"==typeof e}(e)||null!=t||null!=n;if(s)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function Pm(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}class Mm{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jg.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Jg.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Jg.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,s){if(this.sent_)throw jg("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const e in s)s.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,s[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw jg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw jg("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw jg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw jg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Um extends Mm{initXhr(){this.xhr_.responseType="text"}}function Fm(){return new Um}class Vm{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=mm(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled"))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(Yg(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=Mg()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,s,i){const r=t.bucketOnlyServerUrl(),o=Em(t,s,i),a={name:o.fullPath},c=Qg(r,e.host,e._protocol),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=vm(o,n),h=e.maxUploadRetryTime,d=new wm(c,"POST",(function(e){let t;Sm(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){_m(!1)}return _m(zg(t)),t}),h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=Tm(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,Fm,e,t);this._request=s,s.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const s=function(e,t,n,s){const i=e.maxUploadRetryTime,r=new wm(n,"POST",(function(e){const t=Sm(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){_m(!1)}n||_m(!1);const i=Number(n);return _m(!isNaN(i)),new km(i,s.size(),"final"===t)}),i);return r.headers={"X-Goog-Upload-Command":"query"},r.errorHandler=Tm(t),r}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Fm,t,n);this._request=i,i.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=Cm*this._chunkMultiplier,t=new km(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((s,i)=>{let r;try{r=function(e,t,n,s,i,r,o,a){const c=new km(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw new Lg("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const u=c.total-c.current;let l=u;i>0&&(l=Math.min(l,i));const h=c.current,d=h+l;let f="";f=0===l?"finalize":u===l?"upload, finalize":"upload";const p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${c.current}`},g=s.slice(h,d);if(null===g)throw Fg();const m=t.maxUploadRetryTime,y=new wm(n,"POST",(function(e,n){const i=Sm(e,["active","final"]),o=c.current+l,a=s.size();let u;return u="final"===i?bm(t,r)(e,n):null,new km(o,a,"final"===i,u)}),m);return y.headers=p,y.body=g.uploadData(),y.progressCallback=a||null,y.errorHandler=Tm(e),y}(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(r,Fm,s,i,!1);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){Cm*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=function(e,t,n){const s=Qg(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,r=new wm(s,"GET",bm(e,n),i);return r.errorHandler=Im(t),r}(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(n,Fm,e,t);this._request=s,s.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=function(e,t,n,s,i){const r=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=Em(t,s,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+vm(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=lm.getBlob(u,s,l);if(null===h)throw Fg();const d={name:c.fullPath},f=Qg(r,e.host,e._protocol),p=e.maxUploadRetryTime,g=new wm(f,"POST",bm(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=Tm(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,Fm,e,t);this._request=s,s.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Ug(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Lm(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,s){const i=new xm(t||void 0,n||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Lm(this._state)){case Dm:Pm(this._resolve.bind(null,this.snapshot))();break;case Nm:case Om:Pm(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Lm(this._state)){case Am:case Rm:e.next&&Pm(e.next.bind(e,this.snapshot))();break;case Dm:e.complete&&Pm(e.complete.bind(e))();break;default:e.error&&Pm(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class qm{constructor(e,t){this._service=e,this._location=t instanceof $g?t:$g.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new qm(e,t)}get root(){const e=new $g(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dm(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new $g(this._location.bucket,e);return new qm(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Lg("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Bm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const s=Qg(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,r=new wm(s,"GET",function(e,t){return function(n,s){const i=ym(e,s,t);return _m(null!==i),function(e,t,n,s){const i=hm(t);if(null===i)return null;if(!zg(i.downloadTokens))return null;const r=i.downloadTokens;if(0===r.length)return null;const o=encodeURIComponent;return r.split(",").map((t=>{const i=e.bucket,r=e.fullPath;return Qg("/b/"+o(i)+"/o/"+o(r),n,s)+Xg({alt:"media",token:t})}))[0]}(i,s,e.host,e._protocol)}}(e,n),i);return r.errorHandler=Im(t),r}(e.storage,e._location,mm());return e.storage.makeRequestWithTokens(t,Fm).then((e=>{if(null===e)throw new Lg("no-download-url","The given file does not have any download URLs.");return e}))}function jm(e,t){if(e instanceof Hm){const n=e;if(null==n._bucket)throw new Lg("no-default-bucket","No default bucket found. Did you set the '"+Og+"' property when initializing the app?");const s=new qm(n,n._bucket);return null!=t?jm(s,t):s}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),s=new $g(e._location.bucket,n);return new qm(e.storage,s)}(e,t):e}function $m(e,t){const n=null==t?void 0:t[Og];return null==n?null:$g.makeFromBucketSpec(n,e)}class Hm{constructor(e,t,n,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Ng,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=s?$g.makeFromBucketSpec(s,this._host):$m(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=$g.makeFromBucketSpec(this._url,e):this._bucket=$m(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Wg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Wg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qm(this,e)}_makeRequest(e,t,n,s,i=!0){if(this._deleted)return new Hg(qg());{const r=function(e,t,n,s,i,r,o=!0){const a=Xg(e.urlParams),c=e.url+a,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(u,r),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,s),new Zg(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,s,t,this._firebaseVersion,i);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e,t){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,s).getPromise()}}const zm="@firebase/storage",Km="0.10.0",Gm="storage";function Wm(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Vm(e,new lm(t),n)}(e=S(e),t,n)}function Qm(e){return Bm(e=S(e))}function Xm(e,t){return function(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Hm)return new qm(e,t);throw Vg("To use ref(service, url), the first argument must be a Storage instance.")}return jm(e,t)}(e=S(e),t)}he(new C(Gm,(function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new Hm(n,s,i,t,ge)}),"PUBLIC").setMultipleInstances(!0)),ve(zm,Km,""),ve(zm,Km,"esm2017");var Jm=document.getElementById("name__error"),Ym=document.getElementById("email__error"),Zm=document.getElementById("message__error");const ey=(function(e=ye()){const t=de(e=S(e),ut);t.isInitialized()?t.getImmediate():function(e,t={}){const n=de(e,ut);if(n.isInitialized()){const e=n.getImmediate();if(v(t,n.getOptions()))return e;throw ft.create("already-initialized")}n.initialize({options:t})}(e)}(me({apiKey:"AIzaSyB-Zt1GfiH3rjQbPMITywFeU-NZdRFG5vw",authDomain:"portifoilio.firebaseapp.com",projectId:"portifoilio",storageBucket:"portifoilio.appspot.com",messagingSenderId:"963289524335",appId:"1:963289524335:web:f5f2c0d4404c457d36859a",measurementId:"G-1V3GVQ4HZB"})),function(e,t){const n=de(ye(),"firestore").getImmediate({identifier:"(default)"});if(!n._initialized){const e=h("firestore");e&&function(e,t,n,s={}){var i;const r=(e=$h(e,Kh))._getSettings();if("firestore.googleapis.com"!==r.host&&r.host!==t&&zr("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},r),{host:`${t}:${n}`,ssl:!1})),s.mockUserToken){let t,n;if("string"==typeof s.mockUserToken)t=s.mockUserToken,n=Vr.MOCK_USER;else{t=p(s.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const r=s.mockUserToken.sub||s.mockUserToken.user_id;if(!r)throw new Jr(Xr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Vr(r)}e._authCredentials=new to(new Zr(t,n))}}(n,...e)}return n}()),ty=(function(e=ye()){const t=de(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=de(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(v(n.getOptions(),null!=t?t:{}))return e;uf(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Eg,persistence:[Kp,Rp,Np]}),s=d("authTokenSyncURL");if(s){const e=(i=s,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ag)return;const s=null==t?void 0:t.token;Rg!==s&&(Rg=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});!function(e,t,n){S(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,s,i){S(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var i;const r=l("auth");r&&function(e,t,n){const s=ip(e);df(s._canInitEmulator,s,"emulator-config-failed"),df(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),r=op(t),{host:o,port:a}=function(e){const t=op(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const e=i[1];return{host:e,port:ap(s.substr(e.length+1))}}{const[e,t]=s.split(":");return{host:e,port:ap(t)}}}(t),c=null===a?"":`:${a}`;s.config.emulator={url:`${r}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${r}`)}(),function(e=ye(),t){const n=de(e=S(e),Gm).getImmediate({identifier:t}),s=h("storage");return s&&function(e,t,n,s={}){!function(e,t,n,s={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=s;i&&(e._overrideAuthToken="string"==typeof i?i:p(i,e.app.options.projectId))}(e,t,n,s)}(n,...s),n}()),ny=document.getElementById("addCategoryFrm"),sy=Xh(ey,"categories"),iy=Xh(ey,"blogs"),ry=Xh(ey,"projects");ny&&ny.addEventListener("submit",(e=>{e.preventDefault();var t=ny.title.value;Zd(sy,{title:t,status:!0}).then((()=>{ny.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Category created successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px"}),3e3)}))}));let oy=[];ef(Md(sy),(e=>{oy=[],e.docs.forEach((e=>{oy.push({...e.data(),id:e.id})})),document.getElementById("category")&&Lt(oy,"");var t=document.querySelector("table#categories tbody");t&&(t.innerHTML=function(e){var t="";return e.forEach(((e,n)=>{t+=`<tr><td> ${n+1} </td>\n        <td> ${e.title} </td> \n        <td>\n        <a class="edit" href="edit_category.html?category_id=${e.id}"> <button>Edit</button> </a>\n       <button status=${e.status} cat_id=${e.id} class=" status ${e.status?"burn":"revoke"}" > ${e.status?"Burn":"Revoke"} </button>\n        </td>\n        </tr>`})),t}(oy)),document.querySelectorAll("table#categories  td .status").forEach((function(e,t){e.addEventListener("click",(function(e){var t=this.getAttribute("cat_id"),n=this.getAttribute("status"),s="true"!=n;console.log(t,s,n),Yd(Jh(ey,"categories",t),{status:s})}))})),t&&new MutationObserver(((e,t)=>{for(const t of e)"childList"===t.type&&document.querySelectorAll("table#categories  td .status").forEach((function(e,t){e.addEventListener("click",(function(e){var t=this.getAttribute("cat_id"),n="true"!=this.getAttribute("status");Yd(Jh(ey,"categories",t),{status:n})}))}))})).observe(t,{childList:!0,subtree:!0});var n=document.querySelector(".right__summary .categories");n&&(n.innerHTML=function(e){var t="";return e.forEach(((e,n)=>{t+=`<p category__id=${e.id} title=${e.title}  class="category_item"> <img src="assets/images/arrow_right_alt_red.svg" alt=""> ${e.title} </p>`})),t}(oy));const s=window.location.search,i=new URLSearchParams(s);if(i.has("category_id")){const e=i.get("category_id");!function(e){var t=document.getElementById("editCategoryFrm");t.title.value=e.title,t.id.value=e.id}(oy.filter((t=>t.id==e))[0])}var r=document.getElementById("card__number__categories");r&&(r.innerText=oy.length)}));const ay=document.getElementById("editCategoryFrm");ay&&ay.addEventListener("submit",(e=>{e.preventDefault();var t=ay.title.value,n=ay.id.value;Yd(Jh(ey,"categories",n),{title:t}).then((()=>ay.reset()));var s=document.querySelector(".add__message");s.style.padding="10px",s.innerText="Blog Category Updated successfully",ay.reset(),setTimeout((()=>{s.innerText="",s.style.padding="0px",window.location.href="category.html"}),3e3)})),ef(Md(iy,qd("created_at")),(e=>{let t=[];e.docs.forEach((e=>{let n=[];ef(Md(Xh(ey,`blogs/${e.id}/comments`)),(e=>{e.docs.forEach((e=>{n.push({...e.data(),id:e.id})}))})),t.push({...e.data(),id:e.id,comments:n})}));var n=document.querySelector("table#blogs tbody");n&&(n.innerHTML=function(e){var t="";return e.forEach(((e,n)=>{t+=`<tr><td>\n     ${n+1} ${e.status?"":'<i style="color:#ABB6A8" class="fa fa-trash" aria-hidden="true"></i>'} </td>\n        <td> ${e.title} </td> \n        <td> <img  width="100" src="${e.image}" atl="${e.title}" /> </td>\n        <td>${e.views}</td>\n        <td> ${e.comments.length} </td>\n        <td>\n        <a class="view" href="#"> <button>View</button> </a>\n        <a class="edit" href="edit_blog.html?edit_blog=${e.id}"> <button>Edit</button> </a>\n        <button blog_id=${e.id} status=${e.status} class="status ${e.status?"burn":"revoke"}" >  ${e.status?"Burn":"Revoke"} </button>\n        </td></tr>`})),t}(t));var s=document.querySelector(".form-content #category");s&&(s.innerHTML=Lt(oy,""));var i=document.getElementById("card__number__blogs");i&&(i.innerText=t.length);var r=document.querySelector(".latest__blog.blogs_container");r&&(r.innerHTML=xt(t));var o=document.querySelector(".right__summary .most_viewed_blogs");o&&(o.innerHTML=function(e){var t="";return e.forEach(((e,n)=>{t+=` <div class="blog__item">\n    <div class="img">\n      <img src="${e.image}" alt="">\n    </div>\n    <div class="description">\n      <h4 class="title"> ${e.title}  </h4>\n      <p class="time__frame"> <img src="assets/images/Alarm.svg" alt=""> ${Pt(e.created_at)} </p>\n      <div class="comment_views">\n      <p class="comments">\n        <img src="assets/images/inser_ comment.svg" alt="" />\n        <span> ${e.comments.length} </span>\n\n        <img src="assets/images/views.svg" alt="" />\n        <span>${e.views}</span>\n      </p>\n      <a  views=${e.views}  blog_id="${e.id}" href="#" class="read__more" > <i class="fa fa-arrow-right" aria-hidden="true"></i>\n      </a>\n    </div>\n    </div>\n\n  </div>`})),t}(t));var a=document.querySelector(".all__blogs .blogs_container");a&&(a.innerHTML=xt(t)),document.querySelectorAll("table#blogs td .status").forEach((function(e,t){e.addEventListener("click",(function(e){e.preventDefault();var t=this.getAttribute("blog_id"),n="true"!=this.getAttribute("status");Yd(Jh(ey,"blogs",t),{status:n})}))})),n&&new MutationObserver(((e,t)=>{for(const t of e)"childList"===t.type&&document.querySelectorAll("table#blogs td .status").forEach((function(e,t){e.addEventListener("click",(function(e){var t=this.getAttribute("blog_id"),n="true"!=this.getAttribute("status");Yd(Jh(ey,"blogs",t),{status:n})}))}))})).observe(n,{attributes:!0,childList:!0,subtree:!0});var c=document.querySelectorAll("#blogs .item .description .read__more, .latest__blog .item .description .read__more, .blog__item .description .read__more");if(c&&c.forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();var t=this.getAttribute("blog_id"),n=this.getAttribute("views");Yd(Jh(ey,"blogs",t),{views:Number(n)+1}).then((()=>{window.location.href="blog-single.html?blog="+t}))}))})),fy.has("edit_blog")){const e=fy.get("edit_blog");var u=t.filter((t=>t.id==e))[0];e&&(s&&(s.innerHTML=Lt(oy,u.category)),function(e){var t=document.getElementById("editBlogFrm");t.title.value=e.title,t.description.value=e.description,t.id.value=e.id,document.querySelector("form#editBlogFrm #imagePreview").innerHTML="<img width='150' height='100' src='"+e.image+"' />",ClassicEditor.create(document.querySelector("#description")).catch((e=>{console.error(e)}))}(u))}})),ef(Md(ry,qd("created_at")),(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),document.querySelector(".form-content.projects-content").innerHTML=function(e){var t="";return e.forEach(((e,n)=>{t+='<div class="project__item">\n    <div class="top">\n      <div class="image__container">\n        <img width="120" src="../assets/images/blog_1.jpg" alt="" />\n      </div>\n      <div class="links">\n        <h2 class="title">Title</h2>\n        <p><span> GitHub : </span> <a href=""> Git </a></p>\n        <p><span> WEB : </span> <a href=""> WEb </a></p>\n        <p class="description">description</p>\n      </div>\n    </div>\n\n    <div class="options">\n      <a href="#"> Edit </a>\n      <a href="#"> Delete </a>\n    </div>\n  </div>'})),t}(t)}));var cy=document.querySelector(".comments__list .comment__content"),uy=document.querySelector(".blog__content .date__published"),ly=document.querySelector(".comments__list .comment__title"),hy=document.getElementById("commentFrm");const dy=window.location.search,fy=new URLSearchParams(dy);if(fy.has("blog")){const e=fy.get("blog");ef(Jh(ey,"blogs",e),(e=>{var t=document.querySelector(".blog__single__container .blog__content .title"),n=document.querySelector(".blog__single__container .blog__content .blog__content_text"),s=document.querySelector(".blog__single__container .blog__img img"),i={...e.data(),id:e.id};t.innerText=i.title,n.innerHTML=i.description,s.setAttribute("src",i.image),uy.innerHTML=`<img src="assets/images/Alarm.svg" alt="" /> ${Pt(i.created_at)}`}));const t=Xh(ey,`blogs/${e}/comments`);ef(Md(t,qd("comment_date","desc")),(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),cy.innerHTML=function(e){let t="";return e.forEach(((e,n)=>{t+=`<div class="coment__item">\n    <div class="commenter__photo">\n      <img height="50" width="50"  src="assets/images/Ana10_icon.svg" alt="" />\n    </div>\n    <div class="commenter__description">\n\n      <p>\n        <span class="name">${e.name}</span>\n        <span class="comment__date"> ${Pt(e.comment_date)} </span>\n      </p>\n\n      <p class="comment__text">\n      ${e.description}\n      </p>\n\n      <div class="reply"> <a href=""> Reply</a></div>\n    </div>\n  </div>`})),t}(t),ly.innerHTML=`${t.length} <span>Comment(s)</span>`})),hy&&hy.addEventListener("submit",(function(e){e.preventDefault();var n=this.Names.value,s=this.Email.value,i=this.comment__description.value;fy.get("blog"),Zd(t,{name:n,email:s,description:i,comment_date:nf()}).then((()=>{hy.reset()}))}))}var py,gy,my,yy=document.getElementById("image");yy&&yy.addEventListener("change",(e=>{if(function(e){py=e.target.files[0],gy=py.name}(e),!function(e){var t=document.getElementById("image"),n=t.value;if(/(\.jpg|\.jpeg|\.png|\.gif)$/i.exec(n)){if(t.files&&t.files[0]){var s=new FileReader;return s.onload=function(e){document.getElementById("imagePreview").innerHTML='<img width="160" src="'+e.target.result+'"/>'},s.readAsDataURL(t.files[0]),!0}return!0}return alert("Pls Select an image file having extensions .jpeg/.jpg/.png/.gif only."),t.value="",!1}())return!1}));const vy=document.getElementById("addBlogFrm");vy&&vy.addEventListener("submit",(e=>{e.preventDefault();var t=vy.title.value,n=vy.description.value,s=vy.category.value;const i=Wm(Xm(ty,"images/"+gy),py);i.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(e=>(console.log(e),alert("Some problem in upload"),!1)),(()=>{Qm(i.snapshot.ref).then((e=>{my=e,Zd(iy,{title:t,category:s,description:n,created_at:nf(),image:my,views:0,status:!0,comments:""}).then((()=>{vy.reset(),document.getElementById("imagePreview").innerText="",document.getElementById("description").value="";var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Blog created successfully",vy.reset(),setTimeout((()=>{e.innerText="",e.style.padding="0px"}),3e3)}))}))}))}));const wy=document.getElementById("editBlogFrm");wy&&wy.addEventListener("submit",(e=>{e.preventDefault();var t=wy.id.value,n=wy.title.value,s=wy.description.value,i=wy.category.value;const r=new FileReader,o=Wm(Xm(ty,"images/"+gy),py);void 0!==py?(r.readAsDataURL(py),r.addEventListener("load",(function(e){o.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(e=>(console.log(e),alert("Some problem in upload"),!1)),(()=>{Qm(o.snapshot.ref).then((e=>{my=e,console.log(e),Yd(Jh(ey,"blogs",t),{title:n,description:s,image:e,category:i}).then((()=>{wy.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Blog Updated successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px",window.location.href="blogs.html"}),4e3)}))}))}))}))):Yd(Jh(ey,"blogs",t),{title:n,description:s,category:i}).then((()=>{wy.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Blog Updated successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px",window.location.href="blogs.html"}),4e3)}))}));const _y=document.getElementById("addProjectFrm");_y&&_y.addEventListener("submit",(e=>{e.preventDefault();var t=_y.title.value,n=_y.description.value,s=_y.web.value,i=_y.github.value;const r=Wm(Xm(ty,"images/"+gy),py);r.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(e=>(console.log(e),alert("Some problem in upload"),!1)),(()=>{Qm(r.snapshot.ref).then((e=>{my=e,Zd(iy,{title:t,webUrl:s,description:n,created_at:nf(),image:my,githubUrl:i,status:!0}).then((()=>{_y.reset(),document.getElementById("imagePreview").innerText="",document.getElementById("description").value="";var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Project Added successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px"}),3e3)}))}))}))}));const by=document.getElementById("editProjectFrm");by&&by.addEventListener("submit",(e=>{e.preventDefault();var t=by.id.value,n=by.title.value,s=by.description.value,i=by.web.value,r=by.github.value;const o=new FileReader,a=Wm(Xm(ty,"images/"+gy),py);void 0!==py?(o.readAsDataURL(py),o.addEventListener("load",(function(e){a.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(e=>(console.log(e),alert("Some problem in upload"),!1)),(()=>{Qm(a.snapshot.ref).then((e=>{my=e,console.log(e),Yd(Jh(ey,"blogs",t),{title:n,description:s,image:e,githubUrl:r,webUrl:i}).then((()=>{by.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Blog Updated successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px",window.location.href="blogs.html"}),4e3)}))}))}))}))):Yd(Jh(ey,"blogs",t),{title:n,description:s,category}).then((()=>{by.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.innerText="Blog Updated successfully",setTimeout((()=>{e.innerText="",e.style.padding="0px",window.location.href="blogs.html"}),4e3)}))})),document.getElementById("form__error");var Ty=document.getElementById("contact__me__form"),Iy=Xh(ey,"contacts");Ty&&Ty.addEventListener("submit",(function(e){if(e.preventDefault(),(()=>{var e,t=!0;return(0==document.getElementById("contact__name").value.length?(Jm.innerHTML="Name is required",0):(Jm.innerHTML="<i class='fas fa-check-circle' ></i>",1))||(t=!1),(0==(e=document.getElementById("contact__email").value).length?(Ym.innerHTML="Email is required",0):e.match(/^[A-Za-z\._\-[0-9]*[@][A-Za-z]*[\.][a-z]{2,4}$/)?(Ym.innerHTML="<i class='fas fa-check-circle' ></i>",1):(Ym.innerHTML="Email Invalid",0))||(t=!1),(10-document.getElementById("contact__message").value.length>0?(Zm.innerHTML=" minimum 10 characters",0):(Zm.innerHTML="<i class='fas fa-check-circle' ></i>",1))||(t=!1),!!t})()){var t=document.getElementById("contact__name").value,n=document.getElementById("contact__email").value,s=document.getElementById("contact__message").value;Zd(Iy,{name:t,email:n,description:s,created_at:nf()}).then((()=>{Ty.reset();var e=document.querySelector(".add__message");e.style.padding="10px",e.style.color="green",e.innerText="Thank you, we will reply via the email asp",contactForm.reset(),setTimeout((()=>{e.innerText="",e.style.padding="0px"}),1e4)}))}}));var Ey=document.querySelector(".contacts .contact__row");ef(Md(Iy),(e=>{var t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),Ey&&(Ey.innerHTML=function(e){var t="";return e.forEach((e=>{t+=`<div class="message__item">\n    <div class="sender">\n      <h2 class="name">${e.name}</h2>\n      <h5 class="contact_date"> ${Pt(e.created_at||e.contact_date)}    </h5>\n      <h4 class="email"> ${e.email} </h4>\n      <p class="message">\n        ${e.description}\n      </p>\n    </div>\n    <div class="option">\n      <button class="reply">Reply</button>\n    </div>\n  </div>`})),t}(t));var n=document.getElementById("card__number__contacts");n&&(n.innerText=t.length)}))})();